<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ - Begi</title><meta name=author content="Kendrick"><meta name=author-link content="https://kendrickcheung.github.io/"><meta name=description content="æ³¨æ„ æœ¬æ–‡å†…å®¹æ¥æºäºï¼šã€çŸ¥ä¹ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ ğŸ‡ = å’Œ := çš„åŒºåˆ« --æŸ¥çœ‹ç­”æ¡ˆ-- =æ˜¯èµ‹å€¼å˜é‡ï¼Œ:=æ˜¯å®šä¹‰å˜é‡ ğŸˆ æŒ‡é’ˆçš„ä½œç”¨ å±•å¼€æŸ¥"><meta name=keywords content="Goè¯­è¨€ï¼Œé¢è¯•é¢˜"><meta itemprop=name content="ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ"><meta itemprop=description content="æ³¨æ„ æœ¬æ–‡å†…å®¹æ¥æºäºï¼šã€çŸ¥ä¹ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ ğŸ‡ = å’Œ := çš„åŒºåˆ« --æŸ¥çœ‹ç­”æ¡ˆ-- =æ˜¯èµ‹å€¼å˜é‡ï¼Œ:=æ˜¯å®šä¹‰å˜é‡ ğŸˆ æŒ‡é’ˆçš„ä½œç”¨ å±•å¼€æŸ¥"><meta itemprop=datePublished content="2022-10-13T20:36:11+08:00"><meta itemprop=dateModified content="2022-10-18T17:47:50+00:00"><meta itemprop=wordCount content="13834"><meta itemprop=image content="https://kendrickcheung.github.io/logo.png"><meta itemprop=keywords content="zhihu,interview,Golang,"><meta property="og:title" content="ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ"><meta property="og:description" content="æ³¨æ„ æœ¬æ–‡å†…å®¹æ¥æºäºï¼šã€çŸ¥ä¹ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ ğŸ‡ = å’Œ := çš„åŒºåˆ« --æŸ¥çœ‹ç­”æ¡ˆ-- =æ˜¯èµ‹å€¼å˜é‡ï¼Œ:=æ˜¯å®šä¹‰å˜é‡ ğŸˆ æŒ‡é’ˆçš„ä½œç”¨ å±•å¼€æŸ¥"><meta property="og:type" content="article"><meta property="og:url" content="https://kendrickcheung.github.io/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98/"><meta property="og:image" content="https://kendrickcheung.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-13T20:36:11+08:00"><meta property="article:modified_time" content="2022-10-18T17:47:50+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kendrickcheung.github.io/logo.png"><meta name=twitter:title content="ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ"><meta name=twitter:description content="æ³¨æ„ æœ¬æ–‡å†…å®¹æ¥æºäºï¼šã€çŸ¥ä¹ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ ğŸ‡ = å’Œ := çš„åŒºåˆ« --æŸ¥çœ‹ç­”æ¡ˆ-- =æ˜¯èµ‹å€¼å˜é‡ï¼Œ:=æ˜¯å®šä¹‰å˜é‡ ğŸˆ æŒ‡é’ˆçš„ä½œç”¨ å±•å¼€æŸ¥"><meta name=application-name content="Begi"><meta name=apple-mobile-web-app-title content="Begi"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=lamb.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://kendrickcheung.github.io/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98/><link rel=prev href=https://kendrickcheung.github.io/%E8%8B%B1%E8%AF%AD%E6%99%A8%E8%AF%BB%E4%B8%80/><link rel=next href=https://kendrickcheung.github.io/%E5%90%8E%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E9%9B%8601/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kendrickcheung.github.io\/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98\/"},"image":[{"@type":"ImageObject","url":"https:\/\/kendrickcheung.github.io\/images\/Apple-Devices-Preview.jpg","width":1842,"height":1036}],"genre":"posts","keywords":"zhihu, interview, Golang","wordcount":13834,"url":"https:\/\/kendrickcheung.github.io\/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98\/","datePublished":"2022-10-13T20:36:11+08:00","dateModified":"2022-10-18T17:47:50+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"Kendrick","logo":{"@type":"ImageObject","url":"https:\/\/kendrickcheung.github.io\/images\/study-avatar.png","width":1024,"height":1024}},"author":{"@type":"Person","name":"Kendrick"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title=Begi><img class="lazyload logo" src=/svg/loading.min.svg data-src=/lamb.svg data-srcset="/lamb.svg, /lamb.svg 1.5x, /lamb.svg 2x" data-sizes=auto alt=Begi title=Begi><span class=header-title-text>Begi</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> æ‰€æœ‰æ–‡ç« </a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> åˆ†ç±»</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> æ ‡ç­¾</a></li><li class=menu-item><a class=menu-link href=/friends/ title=å‹æƒ…é“¾æ¥><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> å‹é“¾</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> å…³äº</a></li><li class="menu-item delimiter"></li><li class="menu-item language"><span role=button aria-label=é€‰æ‹©è¯­è¨€ title=é€‰æ‹©è¯­è¨€>ç®€ä½“ä¸­æ–‡<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item>æ²¡æœ‰æ›´å¤šç¿»è¯‘</li></ul></li><li class="menu-item search" id=search-desktop><input type=text placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹ ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=æœç´¢><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=æ¸…ç©º><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Begi><img class="lazyload logo" src=/svg/loading.min.svg data-src=/lamb.svg data-srcset="/lamb.svg, /lamb.svg 1.5x, /lamb.svg 2x" data-sizes=auto alt=/lamb.svg title=/lamb.svg><span class=header-title-text>Begi</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹ ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=æœç´¢><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=æ¸…ç©º><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>å–æ¶ˆ</a></li><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> æ‰€æœ‰æ–‡ç« </a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> åˆ†ç±»</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> æ ‡ç­¾</a></li><li class=menu-item><a class=menu-link href=/friends/ title=å‹æƒ…é“¾æ¥><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> å‹é“¾</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> å…³äº</a></li><li class="menu-item text-center"><a class=menu-link href=https://github.com/kendrickcheung/begi title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw' aria-hidden=true></i></a></li><li class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language"><span role=button aria-label=é€‰æ‹©è¯­è¨€ title=é€‰æ‹©è¯­è¨€>ç®€ä½“ä¸­æ–‡<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option disabled>æ²¡æœ‰æ›´å¤šç¿»è¯‘</option></select></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container data-page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>ç›®å½• <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom id=aside-sakana><div class=sakana-widget><div class=sakana-item id=takina-widget></div><div class=sakana-item id=chisato-widget></div></div><script>function initSakanaWidget(){const e=SakanaWidget.getCharacter("takina");SakanaWidget.registerCharacter("takina-slow",e),new SakanaWidget({character:"takina-slow",controls:!1,autoFit:!0,stroke:{color:"#b4b4b4",width:2}}).mount("#takina-widget");const t=SakanaWidget.getCharacter("chisato");SakanaWidget.registerCharacter("chisato-slow",t),new SakanaWidget({character:"chisato-slow",controls:!1,autoFit:!0,stroke:{color:"#b4b4b4",width:2}}).mount("#chisato-widget")}</script><script async onload=initSakanaWidget() src=https://cdn.jsdelivr.net/npm/sakana-widget@2.3.0/lib/sakana.min.js></script></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://kendrickcheung.github.io/ title=ä½œè€… target=_blank rel="external nofollow noopener noreferrer author" class=author><img class="lazyload avatar" src=/svg/loading.min.svg data-src="https://gravatar.loli.net/avatar/cc632f71644a401f82ae230dd3fd84ce?s=32&d=mp" data-srcset="https://gravatar.loli.net/avatar/cc632f71644a401f82ae230dd3fd84ce?s=32&d=mp, https://gravatar.loli.net/avatar/cc632f71644a401f82ae230dd3fd84ce?s=32&d=mp 1.5x, https://gravatar.loli.net/avatar/cc632f71644a401f82ae230dd3fd84ce?s=32&d=mp 2x" data-sizes=auto alt=Kendrick title=Kendrick>&nbsp;Kendrick</a></span>
<span class=post-category>æ”¶å½•äº <a href=/categories/programming/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;ç¼–ç¨‹</a></span></div><div class=post-meta-line><span title="2022-10-13 20:36:11"><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-10-13>2022-10-13</time>
</span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 13834 å­—&nbsp;
<i class="fa-regular fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 28 åˆ†é’Ÿ&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ>
<i class="fa-regular fa-eye fa-fw"></i>&nbsp;<span id=busuanzi_value_page_pv>-</span>&nbsp;æ¬¡é˜…è¯»
</span>&nbsp;</div></div><div class="details toc" id=toc-static kept=false><div class="details-summary toc-title"><span>ç›®å½•</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#--å’Œ--çš„åŒºåˆ«>ğŸ‡ = å’Œ := çš„åŒºåˆ«</a></li><li><a href=#-æŒ‡é’ˆçš„ä½œç”¨>ğŸˆ æŒ‡é’ˆçš„ä½œç”¨</a></li><li><a href=#-goæœ‰å¼‚å¸¸ç±»å‹å—>ğŸ‰ Goæœ‰å¼‚å¸¸ç±»å‹å—</a></li><li><a href=#-ä»€ä¹ˆæ˜¯åç¨‹goroutine>ğŸŠ ä»€ä¹ˆæ˜¯åç¨‹(Goroutine)</a></li><li><a href=#-å¦‚ä½•é«˜æ•ˆåœ°æ‹¼æ¥å­—ç¬¦ä¸²>ğŸ‹ å¦‚ä½•é«˜æ•ˆåœ°æ‹¼æ¥å­—ç¬¦ä¸²</a></li><li><a href=#-ä»€ä¹ˆæ˜¯-rune-ç±»å‹>ğŸŒ ä»€ä¹ˆæ˜¯ rune ç±»å‹</a></li><li><a href=#-å¦‚ä½•åˆ¤æ–­-map-ä¸­æ˜¯å¦åŒ…å«æŸä¸ª-key->ğŸ å¦‚ä½•åˆ¤æ–­ map ä¸­æ˜¯å¦åŒ…å«æŸä¸ª key ï¼Ÿ</a></li><li><a href=#-go-æ”¯æŒé»˜è®¤å‚æ•°æˆ–å¯é€‰å‚æ•°å—>ğŸ¥­ Go æ”¯æŒé»˜è®¤å‚æ•°æˆ–å¯é€‰å‚æ•°å—ï¼Ÿ</a></li><li><a href=#-defer-çš„æ‰§è¡Œé¡ºåº>ğŸ defer çš„æ‰§è¡Œé¡ºåº</a></li><li><a href=#-å¦‚ä½•è·å–ä¸€ä¸ªç»“æ„ä½“çš„æ‰€æœ‰tag>ğŸ å¦‚ä½•è·å–ä¸€ä¸ªç»“æ„ä½“çš„æ‰€æœ‰tagï¼Ÿ</a></li><li><a href=#-å¦‚ä½•åˆ¤æ–­-2-ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡slice-æ˜¯ç›¸ç­‰çš„>ğŸ å¦‚ä½•åˆ¤æ–­ 2 ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼ˆslice) æ˜¯ç›¸ç­‰çš„ï¼Ÿ</a></li><li><a href=#-ç»“æ„ä½“æ‰“å°æ—¶v-å’Œ-v-çš„åŒºåˆ«>ğŸ‘ ç»“æ„ä½“æ‰“å°æ—¶ï¼Œ%v å’Œ %+v çš„åŒºåˆ«</a></li><li><a href=#-go-è¯­è¨€ä¸­å¦‚ä½•è¡¨ç¤ºæšä¸¾å€¼enums>ğŸ’ Go è¯­è¨€ä¸­å¦‚ä½•è¡¨ç¤ºæšä¸¾å€¼(enums)ï¼Ÿ</a></li><li><a href=#-ç©º-struct-çš„ç”¨é€”>ğŸ“ ç©º struct{} çš„ç”¨é€”</a></li><li><a href=#-init-å‡½æ•°æ˜¯ä»€ä¹ˆæ—¶å€™æ‰§è¡Œçš„>ğŸ¥ init() å‡½æ•°æ˜¯ä»€ä¹ˆæ—¶å€™æ‰§è¡Œçš„ï¼Ÿ</a></li><li><a href=#-å¦‚ä½•çŸ¥é“ä¸€ä¸ªå¯¹è±¡æ˜¯åˆ†é…åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Š>ğŸ… å¦‚ä½•çŸ¥é“ä¸€ä¸ªå¯¹è±¡æ˜¯åˆ†é…åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Šï¼Ÿ</a></li><li><a href=#-2ä¸ªnil-å¯èƒ½ä¸ç›¸ç­‰å—>ğŸ¥¥ 2ä¸ªnil å¯èƒ½ä¸ç›¸ç­‰å—ï¼Ÿ</a></li><li><a href=#-ç®€è¿°-go-è¯­è¨€gcåƒåœ¾å›æ”¶çš„å·¥ä½œåŸç†>ğŸ« ç®€è¿° Go è¯­è¨€GC(åƒåœ¾å›æ”¶)çš„å·¥ä½œåŸç†</a></li><li><a href=#-å‡½æ•°è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ˜¯å¦å®‰å…¨>ğŸ«’ å‡½æ•°è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ˜¯å¦å®‰å…¨ï¼Ÿ</a></li><li><a href=#-éæ¥å£çš„ä»»æ„ç±»å‹-t-éƒ½èƒ½å¤Ÿè°ƒç”¨-t-çš„æ–¹æ³•å—åè¿‡æ¥å‘¢>ğŸ¥‘ éæ¥å£çš„ä»»æ„ç±»å‹ T() éƒ½èƒ½å¤Ÿè°ƒç”¨ *T çš„æ–¹æ³•å—ï¼Ÿåè¿‡æ¥å‘¢ï¼Ÿ</a></li><li><a href=#-go-sliceæ˜¯æ€ä¹ˆæ‰©å®¹çš„>ğŸ† go sliceæ˜¯æ€ä¹ˆæ‰©å®¹çš„ï¼Ÿ</a></li><li><a href=#-æ— ç¼“å†²çš„-channel-å’Œæœ‰ç¼“å†²çš„-channel-çš„åŒºåˆ«>ğŸ¥” æ— ç¼“å†²çš„ channel å’Œæœ‰ç¼“å†²çš„ channel çš„åŒºåˆ«ï¼Ÿ</a></li><li><a href=#-ä¸ºä»€ä¹ˆæœ‰åç¨‹æ³„éœ²goroutine-leak>ğŸ¥• ä¸ºä»€ä¹ˆæœ‰åç¨‹æ³„éœ²(Goroutine Leak)ï¼Ÿ</a></li><li><a href=#-go-å¯ä»¥é™åˆ¶è¿è¡Œæ—¶æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„æ•°é‡å—-å¸¸è§çš„goroutineæ“ä½œå‡½æ•°æœ‰å“ªäº›>ğŸŒ½ Go å¯ä»¥é™åˆ¶è¿è¡Œæ—¶æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„æ•°é‡å—ï¼Ÿ å¸¸è§çš„goroutineæ“ä½œå‡½æ•°æœ‰å“ªäº›ï¼Ÿ</a></li><li><a href=#-å¦‚ä½•æ§åˆ¶åç¨‹æ•°ç›®>ğŸŒ¶ï¸ å¦‚ä½•æ§åˆ¶åç¨‹æ•°ç›®ã€‚</a></li><li><a href=#-newå’Œmakeçš„åŒºåˆ«>ğŸ¥’ newå’Œmakeçš„åŒºåˆ«ï¼Ÿ</a></li><li><a href=#-è¯·ä½ è®²ä¸€ä¸‹goé¢å‘å¯¹è±¡æ˜¯å¦‚ä½•å®ç°çš„>ğŸ¥¬ è¯·ä½ è®²ä¸€ä¸‹Goé¢å‘å¯¹è±¡æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</a></li><li><a href=#-init-å‡½æ•°>ğŸ¥¦ init å‡½æ•°</a></li><li><a href=#-ä¸‹é¢è¿™å¥ä»£ç æ˜¯ä»€ä¹ˆä½œç”¨ä¸ºä»€ä¹ˆè¦å®šä¹‰ä¸€ä¸ªç©ºå€¼>ğŸ„ ä¸‹é¢è¿™å¥ä»£ç æ˜¯ä»€ä¹ˆä½œç”¨ï¼Œä¸ºä»€ä¹ˆè¦å®šä¹‰ä¸€ä¸ªç©ºå€¼ï¼Ÿ</a></li><li><a href=#-golangçš„å†…å­˜ç®¡ç†çš„åŸç†æ¸…æ¥šå—ç®€è¿°goå†…å­˜ç®¡ç†æœºåˆ¶>ğŸŒ° golangçš„å†…å­˜ç®¡ç†çš„åŸç†æ¸…æ¥šå—ï¼Ÿç®€è¿°goå†…å­˜ç®¡ç†æœºåˆ¶ã€‚</a></li><li><a href=#-mutexæœ‰å‡ ç§æ¨¡å¼>ğŸ«‘ mutexæœ‰å‡ ç§æ¨¡å¼ï¼Ÿ</a></li><li><a href=#-goå¦‚ä½•è¿›è¡Œè°ƒåº¦çš„gmpä¸­çŠ¶æ€æµè½¬>ğŸ goå¦‚ä½•è¿›è¡Œè°ƒåº¦çš„ã€‚GMPä¸­çŠ¶æ€æµè½¬ã€‚</a></li><li><a href=#-goä»€ä¹ˆæ—¶å€™å‘ç”Ÿé˜»å¡é˜»å¡æ—¶è°ƒåº¦å™¨ä¼šæ€ä¹ˆåš>ğŸ¥– Goä»€ä¹ˆæ—¶å€™å‘ç”Ÿé˜»å¡ï¼Ÿé˜»å¡æ—¶ï¼Œè°ƒåº¦å™¨ä¼šæ€ä¹ˆåšã€‚</a></li><li><a href=#-goä¸­gmpæœ‰å“ªäº›çŠ¶æ€>ğŸ¥¨ Goä¸­GMPæœ‰å“ªäº›çŠ¶æ€ï¼Ÿ</a></li><li><a href=#-gmpèƒ½ä¸èƒ½å»æ‰på±‚ä¼šæ€ä¹ˆæ ·>ğŸ¥¯ GMPèƒ½ä¸èƒ½å»æ‰På±‚ï¼Ÿä¼šæ€ä¹ˆæ ·ï¼Ÿ</a></li><li><a href=#-å¦‚æœæœ‰ä¸€ä¸ªgä¸€ç›´å ç”¨èµ„æºæ€ä¹ˆåŠä»€ä¹ˆæ˜¯work-stealingç®—æ³•>ğŸ§€ å¦‚æœæœ‰ä¸€ä¸ªGä¸€ç›´å ç”¨èµ„æºæ€ä¹ˆåŠï¼Ÿä»€ä¹ˆæ˜¯work stealingç®—æ³•ï¼Ÿ</a></li><li><a href=#-goroutineä»€ä¹ˆæƒ…å†µä¼šå‘ç”Ÿå†…å­˜æ³„æ¼å¦‚ä½•é¿å…>ğŸ– goroutineä»€ä¹ˆæƒ…å†µä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ï¼Ÿå¦‚ä½•é¿å…ã€‚</a></li><li><a href=#-go-gcæœ‰å‡ ä¸ªé˜¶æ®µ>ğŸ— Go GCæœ‰å‡ ä¸ªé˜¶æ®µ</a></li><li><a href=#-goç«æ€æ¡ä»¶äº†è§£å—>ğŸ¥© goç«æ€æ¡ä»¶äº†è§£å—ï¼Ÿ</a></li><li><a href=#-å¦‚æœè‹¥å¹²ä¸ªgoroutineæœ‰ä¸€ä¸ªpanicä¼šæ€ä¹ˆåš>ğŸ¥“ å¦‚æœè‹¥å¹²ä¸ªgoroutineï¼Œæœ‰ä¸€ä¸ªpanicä¼šæ€ä¹ˆåšï¼Ÿ</a></li><li><a href=#-deferå¯ä»¥æ•è·goroutineçš„å­goroutineå—>ğŸ” deferå¯ä»¥æ•è·goroutineçš„å­goroutineå—ï¼Ÿ</a></li><li><a href=#-grpcæ˜¯ä»€ä¹ˆ>ğŸŸ gRPCæ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li><a href=#-å¾®æœåŠ¡äº†è§£å—>ğŸ• å¾®æœåŠ¡äº†è§£å—ï¼Ÿ</a></li><li><a href=#-æœåŠ¡å‘ç°æ˜¯æ€ä¹ˆåšçš„>ğŸŒ­ æœåŠ¡å‘ç°æ˜¯æ€ä¹ˆåšçš„ï¼Ÿ</a></li><li><a href=#-etcdç”¨è¿‡å—>ğŸ¥ª ETCDç”¨è¿‡å—ï¼Ÿ</a></li><li><a href=#-ginæ€ä¹ˆåšå‚æ•°æ ¡éªŒ>ğŸŒ® GINæ€ä¹ˆåšå‚æ•°æ ¡éªŒï¼Ÿ</a></li><li><a href=#-ä¸­é—´ä»¶ç”¨è¿‡å—>ğŸŒ¯ ä¸­é—´ä»¶ç”¨è¿‡å—ï¼Ÿ</a></li><li><a href=#-goè§£ætagæ˜¯æ€ä¹ˆå®ç°çš„>ğŸ¥™ Goè§£æTagæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</a></li><li><a href=#-ä½ é¡¹ç›®æœ‰ä¼˜é›…çš„å¯åœå—>ğŸ² ä½ é¡¹ç›®æœ‰ä¼˜é›…çš„å¯åœå—ï¼Ÿ</a></li><li><a href=#-æŒä¹…åŒ–æ€ä¹ˆåšçš„>ğŸ¥— æŒä¹…åŒ–æ€ä¹ˆåšçš„ï¼Ÿ</a></li><li><a href=#-channel-æ­»é”çš„åœºæ™¯>ğŸ¿ channel æ­»é”çš„åœºæ™¯</a></li><li><a href=#-å¯¹å·²ç»å…³é—­çš„chanè¿›è¡Œè¯»å†™ä¼šæ€ä¹ˆæ ·>ğŸ¥« å¯¹å·²ç»å…³é—­çš„chanè¿›è¡Œè¯»å†™ä¼šæ€ä¹ˆæ ·ï¼Ÿ</a></li><li><a href=#-è¯´è¯´-atomicåº•å±‚æ€ä¹ˆå®ç°çš„>ğŸ± è¯´è¯´ atomicåº•å±‚æ€ä¹ˆå®ç°çš„.</a></li><li><a href=#-channelåº•å±‚å®ç°æ˜¯å¦çº¿ç¨‹å®‰å…¨>ğŸ˜ channelåº•å±‚å®ç°ï¼Ÿæ˜¯å¦çº¿ç¨‹å®‰å…¨ã€‚</a></li><li><a href=#-mapçš„åº•å±‚å®ç°>ğŸš mapçš„åº•å±‚å®ç°ã€‚</a></li><li><a href=#-selectçš„å®ç°åŸç†>ğŸ› selectçš„å®ç°åŸç†ï¼Ÿ</a></li><li><a href=#-goçš„interfaceæ€ä¹ˆå®ç°çš„>ğŸœ goçš„interfaceæ€ä¹ˆå®ç°çš„ï¼Ÿ</a></li><li><a href=#-goçš„reflect-åº•å±‚å®ç°>ğŸ goçš„reflect åº•å±‚å®ç°</a></li><li><a href=#-go-gcçš„åŸç†çŸ¥é“å—>ğŸ  go GCçš„åŸç†çŸ¥é“å—ï¼Ÿ</a></li><li><a href=#-goé‡Œç”¨è¿‡å“ªäº›è®¾è®¡æ¨¡å¼->ğŸ¢ goé‡Œç”¨è¿‡å“ªäº›è®¾è®¡æ¨¡å¼ ?</a></li><li><a href=#-goçš„è°ƒè¯•åˆ†æå·¥å…·ç”¨è¿‡å“ªäº›>ğŸ£ goçš„è°ƒè¯•/åˆ†æå·¥å…·ç”¨è¿‡å“ªäº›ã€‚</a></li><li><a href=#è¿›ç¨‹è¢«killå¦‚ä½•ä¿è¯æ‰€æœ‰goroutineé¡ºåˆ©é€€å‡º>ğŸ¤è¿›ç¨‹è¢«killï¼Œå¦‚ä½•ä¿è¯æ‰€æœ‰goroutineé¡ºåˆ©é€€å‡º</a></li><li><a href=#-è¯´è¯´contextåŒ…çš„ä½œç”¨ä½ ç”¨è¿‡å“ªäº›åŸç†çŸ¥é“å—>ğŸ¥ è¯´è¯´contextåŒ…çš„ä½œç”¨ï¼Ÿä½ ç”¨è¿‡å“ªäº›ï¼ŒåŸç†çŸ¥é“å—ï¼Ÿ</a></li><li><a href=#-grpcä¸ºå•¥å¥½åŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆå’Œhttpæ¯”å‘¢>ğŸ¥® grpcä¸ºå•¥å¥½ï¼ŒåŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆï¼Œå’Œhttpæ¯”å‘¢</a></li><li><a href=#å®ç°ä½¿ç”¨å­—ç¬¦ä¸²å‡½æ•°åè°ƒç”¨å‡½æ•°>ğŸ¡å®ç°ä½¿ç”¨å­—ç¬¦ä¸²å‡½æ•°åï¼Œè°ƒç”¨å‡½æ•°ã€‚</a></li><li><a href=#-goroutineæœ‰ä¸‰ä¸ªå‡½æ•°åˆ†åˆ«æ‰“å°cat-fishdogè¦æ±‚æ¯ä¸€ä¸ªå‡½æ•°éƒ½ç”¨ä¸€ä¸ªgoroutineæŒ‰ç…§é¡ºåºæ‰“å°100æ¬¡>ğŸ¥Ÿ ï¼ˆGoroutineï¼‰æœ‰ä¸‰ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«æ‰“å°"cat", &ldquo;fish&rdquo;,&ldquo;dog"è¦æ±‚æ¯ä¸€ä¸ªå‡½æ•°éƒ½ç”¨ä¸€ä¸ªgoroutineï¼ŒæŒ‰ç…§é¡ºåºæ‰“å°100æ¬¡ã€‚</a></li><li><a href=#-ä¸¤ä¸ªåç¨‹äº¤æ›¿æ‰“å°10ä¸ªå­—æ¯å’Œæ•°å­—>ğŸ¦€ ä¸¤ä¸ªåç¨‹äº¤æ›¿æ‰“å°10ä¸ªå­—æ¯å’Œæ•°å­—</a></li><li><a href=#-å¯åŠ¨-2ä¸ªgroutine-2ç§’åå–æ¶ˆ-ç¬¬ä¸€ä¸ªåç¨‹1ç§’æ‰§è¡Œå®Œç¬¬äºŒä¸ªåç¨‹3ç§’æ‰§è¡Œå®Œ>ğŸ¦ å¯åŠ¨ 2ä¸ªgroutine 2ç§’åå–æ¶ˆï¼Œ ç¬¬ä¸€ä¸ªåç¨‹1ç§’æ‰§è¡Œå®Œï¼Œç¬¬äºŒä¸ªåç¨‹3ç§’æ‰§è¡Œå®Œã€‚</a></li><li><a href=#-å½“selectç›‘æ§å¤šä¸ªchanåŒæ—¶åˆ°è¾¾å°±ç»ªæ€æ—¶å¦‚ä½•å…ˆæ‰§è¡ŒæŸä¸ªä»»åŠ¡>ğŸ¦ å½“selectç›‘æ§å¤šä¸ªchanåŒæ—¶åˆ°è¾¾å°±ç»ªæ€æ—¶ï¼Œå¦‚ä½•å…ˆæ‰§è¡ŒæŸä¸ªä»»åŠ¡ï¼Ÿ</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden=true></i>æ³¨æ„<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>æœ¬æ–‡å†…å®¹æ¥æºäºï¼š<a href=https://zhuanlan.zhihu.com/p/471490292 target=_blank rel="external nofollow noopener noreferrer">ã€çŸ¥ä¹ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></div></div></div><h4 id=--å’Œ--çš„åŒºåˆ«>ğŸ‡ = å’Œ := çš„åŒºåˆ«</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide>=æ˜¯èµ‹å€¼å˜é‡ï¼Œ:=æ˜¯å®šä¹‰å˜é‡</span></div><h4 id=-æŒ‡é’ˆçš„ä½œç”¨>ğŸˆ æŒ‡é’ˆçš„ä½œç”¨</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><ul><li>è·å–å˜é‡çš„å€¼</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=nx>fmt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>  <span class=nx>a</span> <span class=o>:=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=nx>p</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>a</span> <span class=c1>// è·å–åœ°å€
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>fmt</span><span class=p>.</span><span class=nf>Prinf</span><span class=p>(</span><span class=o>*</span><span class=nx>p</span><span class=p>)</span> <span class=c1>// è·å–å€¼
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>æ”¹å˜å˜é‡çš„å€¼</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// äº¤æ¢å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>swap</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span><span class=nx>b</span> <span class=o>*</span><span class=kt>int</span><span class=p>){</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span><span class=nx>a</span><span class=p>,</span><span class=o>*</span><span class=nx>b</span> <span class=p>=</span> <span class=o>*</span><span class=nx>b</span><span class=p>,</span><span class=o>*</span><span class=nx>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>ç”¨æŒ‡é’ˆæ›¿ä»£ä¼ å…¥å‡½æ•°</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>A</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=o>*</span><span class=nx>A</span><span class=p>)</span> <span class=nf>fun</span><span class=p>(){}</span>
</span></span></code></pre></td></tr></table></div></div></details><h4 id=-goæœ‰å¼‚å¸¸ç±»å‹å—>ğŸ‰ Goæœ‰å¼‚å¸¸ç±»å‹å—</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p>æœ‰ã€‚ Goç”¨errorç±»å‹ä»£æ›¿try&mldr;catch</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>_</span><span class=p>,</span><span class=nx>err</span> <span class=o>:=</span> <span class=nf>funcDemo</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¹Ÿå¯ä»¥ç”¨errors.New()æ¥å®šä¹‰è‡ªå·±çš„å¼‚å¸¸ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>errorString</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>s</span> <span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>e</span> <span class=o>*</span><span class=nx>errorString</span><span class=p>)</span> <span class=nf>Error</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>e</span><span class=p>.</span><span class=nx>s</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// å¤šä¸€ä¸ªå‡½æ•°å½“ä½œæ„é€ å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>New</span><span class=p>(</span><span class=nx>text</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=o>&amp;</span><span class=nx>errorString</span><span class=p>{</span><span class=nx>text</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h4 id=-ä»€ä¹ˆæ˜¯åç¨‹goroutine>ğŸŠ ä»€ä¹ˆæ˜¯åç¨‹(Goroutine)</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide>åç¨‹æ˜¯<em>ç”¨æˆ·çŠ¶æ€è½»é‡çº§çº¿ç¨‹</em>ï¼Œå®ƒæ˜¯<em>çº¿ç¨‹è°ƒåº¦çš„åŸºæœ¬å•ä½</em></span></div><details><summary>å±•å¼€äº†è§£æ›´å¤š</summary>
<em>é€šå¸¸åœ¨å‡½æ•°å‰åŠ ä¸Šgoå…³é”®å­—å°±èƒ½å®ç°å¹¶å‘ã€‚ä¸€ä¸ªGoroutineä¼šä»¥ä¸€ä¸ªå¾ˆå°çš„æ ˆå¯åŠ¨2KBæˆ–4KBï¼Œå½“é‡åˆ°æ ˆç©ºé—´ä¸è¶³æ—¶ï¼Œæ ˆä¼šè‡ªåŠ¨ä¼¸ç¼©ï¼Œ å› æ­¤å¯ä»¥è½»æ˜“å®ç°æˆåƒä¸Šä¸‡ä¸ªgoroutineåŒæ—¶å¯åŠ¨ã€‚</em></details><h4 id=-å¦‚ä½•é«˜æ•ˆåœ°æ‹¼æ¥å­—ç¬¦ä¸²>ğŸ‹ å¦‚ä½•é«˜æ•ˆåœ°æ‹¼æ¥å­—ç¬¦ä¸²</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide>strings.Join â‰ˆ strings.Builder > bytes.Buffer > &ldquo;+&rdquo; > fmt.Sprintf</span></div><details><summary>å±•å¼€äº†è§£æ›´å¤š</summary><p><strong>åˆ©ç”¨åŠ å·(+)</strong></p><p>ä½¿ç”¨+æ“ä½œç¬¦è¿›è¡Œæ‹¼æ¥æ—¶ï¼Œä¼šå¯¹å­—ç¬¦ä¸²è¿›è¡Œéå†ï¼Œè®¡ç®—å¹¶å¼€è¾Ÿä¸€ä¸ªæ–°çš„ç©ºé—´æ¥å­˜å‚¨åŸæ¥çš„ä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚</p><p><strong>fmt.Sprintf</strong></p><p>ç”±äºé‡‡ç”¨äº†æ¥å£å‚æ•°ï¼Œå¿…é¡»è¦ç”¨åå°„è·å–å€¼ï¼Œå› æ­¤æœ‰æ€§èƒ½æŸè€—ã€‚</p><p><strong>strings.Builder</strong></p><p>ç”¨WriteString()è¿›è¡Œæ‹¼æ¥ï¼Œå†…éƒ¨å®ç°æ˜¯æŒ‡é’ˆ+åˆ‡ç‰‡ï¼ŒåŒæ—¶String()è¿”å›æ‹¼æ¥åçš„å­—ç¬¦ä¸²ï¼Œå®ƒæ˜¯ç›´æ¥æŠŠ[]byteè½¬æ¢ä¸ºstringï¼Œä»è€Œé¿å…å˜é‡æ‹·è´ã€‚</p><p><strong>bytes.Buffer</strong></p><p>bytes.Bufferæ˜¯ä¸€ä¸ªä¸€ä¸ªç¼“å†²byteç±»å‹çš„ç¼“å†²å™¨ï¼Œè¿™ä¸ªç¼“å†²å™¨é‡Œå­˜æ”¾ç€éƒ½æ˜¯byteï¼Œbytes.bufferåº•å±‚ä¹Ÿæ˜¯ä¸€ä¸ª[]byteåˆ‡ç‰‡ã€‚</p><p><strong>strings.join</strong></p><p>strings.joinä¹Ÿæ˜¯åŸºäºstrings.builderæ¥å®ç°çš„,å¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰åˆ†éš”ç¬¦ï¼Œåœ¨joinæ–¹æ³•å†…è°ƒç”¨äº†b.Grow(n)æ–¹æ³•ï¼Œè¿™ä¸ªæ˜¯è¿›è¡Œåˆæ­¥çš„å®¹é‡åˆ†é…ï¼Œè€Œå‰é¢è®¡ç®—çš„nçš„é•¿åº¦å°±æ˜¯æˆ‘ä»¬è¦æ‹¼æ¥çš„sliceçš„é•¿åº¦ï¼Œå› ä¸ºæˆ‘ä»¬ä¼ å…¥åˆ‡ç‰‡é•¿åº¦å›ºå®šï¼Œæ‰€ä»¥æå‰è¿›è¡Œå®¹é‡åˆ†é…å¯ä»¥å‡å°‘å†…å­˜åˆ†é…ï¼Œå¾ˆé«˜æ•ˆã€‚</p></details><h4 id=-ä»€ä¹ˆæ˜¯-rune-ç±»å‹>ğŸŒ ä»€ä¹ˆæ˜¯ rune ç±»å‹</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide>Unicodeåœ¨ Go è¯­è¨€ä¸­ç§°ä¹‹ä¸º runeï¼Œæ˜¯ int32 ç±»å‹çš„åˆ«åã€‚</span></div><h4 id=-å¦‚ä½•åˆ¤æ–­-map-ä¸­æ˜¯å¦åŒ…å«æŸä¸ª-key->ğŸ å¦‚ä½•åˆ¤æ–­ map ä¸­æ˜¯å¦åŒ…å«æŸä¸ª key ï¼Ÿ</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>sample</span> <span class=kd>map</span><span class=p>[</span><span class=kt>int</span><span class=p>]</span><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>sample</span><span class=p>[</span><span class=mi>10</span><span class=p>];</span> <span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=-go-æ”¯æŒé»˜è®¤å‚æ•°æˆ–å¯é€‰å‚æ•°å—>ğŸ¥­ Go æ”¯æŒé»˜è®¤å‚æ•°æˆ–å¯é€‰å‚æ•°å—ï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide>ä¸æ”¯æŒã€‚ä½†æ˜¯å¯ä»¥åˆ©ç”¨ç»“æ„ä½“å‚æ•°ï¼Œæˆ–è€…&mldr;ä¼ å…¥å‚æ•°åˆ‡ç‰‡æ•°ç»„ã€‚</span></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// è¿™ä¸ªå‡½æ•°å¯ä»¥ä¼ å…¥ä»»æ„æ•°é‡çš„æ•´å‹å‚æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>sum</span><span class=p>(</span><span class=nx>nums</span> <span class=o>...</span><span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>total</span> <span class=o>:=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>num</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>nums</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>total</span> <span class=o>+=</span> <span class=nx>num</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>total</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=-defer-çš„æ‰§è¡Œé¡ºåº>ğŸ defer çš„æ‰§è¡Œé¡ºåº</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide>deferæ‰§è¡Œé¡ºåºå’Œè°ƒç”¨é¡ºåºç›¸åï¼Œç±»ä¼¼äºæ ˆåè¿›å…ˆå‡º(LIFO)ã€‚</span></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>test</span><span class=p>()</span> <span class=kt>int</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;defer1&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}()</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;defer2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}()</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;return&#34;</span><span class=p>,</span> <span class=nf>test</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// defer2
</span></span></span><span class=line><span class=cl><span class=c1>// defer1
</span></span></span><span class=line><span class=cl><span class=c1>// return 0
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>test</span><span class=p>()</span> <span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>i</span> <span class=p>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;defer2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}()</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>i</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;return&#34;</span><span class=p>,</span> <span class=nf>test</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// defer2
</span></span></span><span class=line><span class=cl><span class=c1>// return 1
</span></span></span></code></pre></td></tr></table></div></div><h4 id=-å¦‚ä½•è·å–ä¸€ä¸ªç»“æ„ä½“çš„æ‰€æœ‰tag>ğŸ å¦‚ä½•è·å–ä¸€ä¸ªç»“æ„ä½“çš„æ‰€æœ‰tagï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹</summary><p><em>åˆ©ç”¨åå°„</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>import</span> <span class=nx>reflect</span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Author</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>Name</span>         <span class=kt>int</span>      <span class=s>`json:Name`</span>
</span></span><span class=line><span class=cl>	<span class=nx>Publications</span> <span class=p>[]</span><span class=kt>string</span> <span class=s>`json:Publication,omitempty`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>t</span> <span class=o>:=</span> <span class=nx>reflect</span><span class=p>.</span><span class=nf>TypeOf</span><span class=p>(</span><span class=nx>Author</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=nx>t</span><span class=p>.</span><span class=nf>NumField</span><span class=p>();</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>name</span> <span class=o>:=</span> <span class=nx>t</span><span class=p>.</span><span class=nf>Field</span><span class=p>(</span><span class=nx>i</span><span class=p>).</span><span class=nx>Name</span>
</span></span><span class=line><span class=cl>		<span class=nx>s</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>t</span><span class=p>.</span><span class=nf>FieldByName</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>s</span><span class=p>.</span><span class=nx>Tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h4 id=-å¦‚ä½•åˆ¤æ–­-2-ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡slice-æ˜¯ç›¸ç­‰çš„>ğŸ å¦‚ä½•åˆ¤æ–­ 2 ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼ˆslice) æ˜¯ç›¸ç­‰çš„ï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide>reflect.DeepEqual() ï¼Œ ä½†åå°„éå¸¸å½±å“æ€§èƒ½ã€‚</span></div><h4 id=-ç»“æ„ä½“æ‰“å°æ—¶v-å’Œ-v-çš„åŒºåˆ«>ğŸ‘ ç»“æ„ä½“æ‰“å°æ—¶ï¼Œ%v å’Œ %+v çš„åŒºåˆ«</h4><details><summary>å±•å¼€æŸ¥çœ‹</summary><p>%vè¾“å‡ºç»“æ„ä½“å„æˆå‘˜çš„å€¼ï¼›</p><p>%+vè¾“å‡ºç»“æ„ä½“å„æˆå‘˜çš„åç§°å’Œå€¼ï¼›</p><p>%#vè¾“å‡ºç»“æ„ä½“åç§°å’Œç»“æ„ä½“å„æˆå‘˜çš„åç§°å’Œå€¼</p></details><h4 id=-go-è¯­è¨€ä¸­å¦‚ä½•è¡¨ç¤ºæšä¸¾å€¼enums>ğŸ’ Go è¯­è¨€ä¸­å¦‚ä½•è¡¨ç¤ºæšä¸¾å€¼(enums)ï¼Ÿ</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>B</span> <span class=p>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=mi>10</span> <span class=o>*</span> <span class=kc>iota</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>KiB</span> 
</span></span><span class=line><span class=cl>	<span class=nx>MiB</span>
</span></span><span class=line><span class=cl>	<span class=nx>GiB</span>
</span></span><span class=line><span class=cl>	<span class=nx>TiB</span>
</span></span><span class=line><span class=cl>	<span class=nx>PiB</span>
</span></span><span class=line><span class=cl>	<span class=nx>EiB</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=-ç©º-struct-çš„ç”¨é€”>ğŸ“ ç©º struct{} çš„ç”¨é€”</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>ç”¨mapæ¨¡æ‹Ÿä¸€ä¸ªsetï¼Œé‚£ä¹ˆå°±è¦æŠŠå€¼ç½®ä¸ºstruct{}ï¼Œstruct{}æœ¬èº«ä¸å ä»»ä½•ç©ºé—´ï¼Œå¯ä»¥é¿å…ä»»ä½•å¤šä½™çš„å†…å­˜åˆ†é…ã€‚</em></span></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Set</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>set</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=nx>Set</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>item</span> <span class=o>:=</span> <span class=k>range</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;A&#34;</span><span class=p>,</span> <span class=s>&#34;A&#34;</span><span class=p>,</span> <span class=s>&#34;B&#34;</span><span class=p>,</span> <span class=s>&#34;C&#34;</span><span class=p>}</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>set</span><span class=p>[</span><span class=nx>item</span><span class=p>]</span> <span class=p>=</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>set</span><span class=p>))</span> <span class=c1>// 3
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>set</span><span class=p>[</span><span class=s>&#34;A&#34;</span><span class=p>];</span> <span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;A exists&#34;</span><span class=p>)</span> <span class=c1>// A exists
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=-init-å‡½æ•°æ˜¯ä»€ä¹ˆæ—¶å€™æ‰§è¡Œçš„>ğŸ¥ init() å‡½æ•°æ˜¯ä»€ä¹ˆæ—¶å€™æ‰§è¡Œçš„ï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>åœ¨mainå‡½æ•°ä¹‹å‰æ‰§è¡Œã€‚</em></span></div><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p>init()å‡½æ•°æ˜¯goåˆå§‹åŒ–çš„ä¸€éƒ¨åˆ†ï¼Œç”±runtimeåˆå§‹åŒ–æ¯ä¸ªå¯¼å…¥çš„åŒ…ï¼Œåˆå§‹åŒ–ä¸æ˜¯æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„å¯¼å…¥é¡ºåºï¼Œè€Œæ˜¯æŒ‰ç…§è§£æçš„ä¾èµ–å…³ç³»ï¼Œæ²¡æœ‰ä¾èµ–çš„åŒ…æœ€å…ˆåˆå§‹åŒ–ã€‚</p><p>æ¯ä¸ªåŒ…é¦–å…ˆåˆå§‹åŒ–åŒ…ä½œç”¨åŸŸçš„å¸¸é‡å’Œå˜é‡ï¼ˆå¸¸é‡ä¼˜å…ˆäºå˜é‡ï¼‰ï¼Œç„¶åæ‰§è¡ŒåŒ…çš„init()å‡½æ•°ã€‚åŒä¸€ä¸ªåŒ…ï¼Œç”šè‡³æ˜¯åŒä¸€ä¸ªæºæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªinit()å‡½æ•°ã€‚init()å‡½æ•°æ²¡æœ‰å…¥å‚å’Œè¿”å›å€¼ï¼Œä¸èƒ½è¢«å…¶ä»–å‡½æ•°è°ƒç”¨ï¼ŒåŒä¸€ä¸ªåŒ…å†…å¤šä¸ªinit()å‡½æ•°çš„æ‰§è¡Œé¡ºåºä¸ä½œä¿è¯ã€‚</p><p>æ‰§è¡Œé¡ºåºï¼šimport â€“> const â€“> var â€“>init()â€“>main()</p><p>ä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªinit()å‡½æ•°ï¼</p></details><h4 id=-å¦‚ä½•çŸ¥é“ä¸€ä¸ªå¯¹è±¡æ˜¯åˆ†é…åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Š>ğŸ… å¦‚ä½•çŸ¥é“ä¸€ä¸ªå¯¹è±¡æ˜¯åˆ†é…åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Šï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>Goå’ŒC++ä¸åŒï¼ŒGoå±€éƒ¨å˜é‡ä¼šè¿›è¡Œé€ƒé€¸åˆ†æã€‚å¦‚æœå˜é‡ç¦»å¼€ä½œç”¨åŸŸåæ²¡æœ‰è¢«å¼•ç”¨ï¼Œåˆ™ä¼˜å…ˆåˆ†é…åˆ°æ ˆä¸Šï¼Œå¦åˆ™åˆ†é…åˆ°å †ä¸Šã€‚</em></span></div><h4 id=-2ä¸ªnil-å¯èƒ½ä¸ç›¸ç­‰å—>ğŸ¥¥ 2ä¸ªnil å¯èƒ½ä¸ç›¸ç­‰å—ï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>å¯èƒ½ä¸ç­‰ã€‚interfaceåœ¨è¿è¡Œæ—¶ç»‘å®šå€¼ï¼Œåªæœ‰å€¼ä¸ºnilæ¥å£å€¼æ‰ä¸ºnilï¼Œä½†æ˜¯ä¸æŒ‡é’ˆçš„nilä¸ç›¸ç­‰ã€‚</em></span></div><h4 id=-ç®€è¿°-go-è¯­è¨€gcåƒåœ¾å›æ”¶çš„å·¥ä½œåŸç†>ğŸ« ç®€è¿° Go è¯­è¨€GC(åƒåœ¾å›æ”¶)çš„å·¥ä½œåŸç†</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>åƒåœ¾å›æ”¶æœºåˆ¶æ˜¯Goä¸€å¤§ç‰¹(nan)è‰²(dian)ã€‚Go1.3é‡‡ç”¨æ ‡è®°æ¸…é™¤æ³•ï¼Œ Go1.5é‡‡ç”¨ä¸‰è‰²æ ‡è®°æ³•ï¼ŒGo1.8é‡‡ç”¨ä¸‰è‰²æ ‡è®°æ³•+æ··åˆå†™å±éšœã€‚</em></span></div><h4 id=-å‡½æ•°è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ˜¯å¦å®‰å…¨>ğŸ«’ å‡½æ•°è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ˜¯å¦å®‰å…¨ï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>è¿™ä¸€ç‚¹å’ŒC++ä¸åŒï¼Œåœ¨Goé‡Œé¢è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ˜¯å®‰å…¨çš„ã€‚å› ä¸ºGoä¼šè¿›è¡Œé€ƒé€¸åˆ†æï¼Œå¦‚æœå‘ç°å±€éƒ¨å˜é‡çš„ä½œç”¨åŸŸè¶…è¿‡è¯¥å‡½æ•°åˆ™ä¼šæŠŠæŒ‡é’ˆåˆ†é…åˆ°å †åŒºï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</em></span></div><h4 id=-éæ¥å£çš„ä»»æ„ç±»å‹-t-éƒ½èƒ½å¤Ÿè°ƒç”¨-t-çš„æ–¹æ³•å—åè¿‡æ¥å‘¢>ğŸ¥‘ éæ¥å£çš„ä»»æ„ç±»å‹ T() éƒ½èƒ½å¤Ÿè°ƒç”¨ *T çš„æ–¹æ³•å—ï¼Ÿåè¿‡æ¥å‘¢ï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>ä¸€ä¸ªTç±»å‹çš„å€¼å¯ä»¥è°ƒç”¨</em>Tç±»å‹å£°æ˜çš„æ–¹æ³•ï¼Œå½“ä¸”ä»…å½“Tæ˜¯å¯å¯»å€çš„ã€‚åä¹‹ï¼š<em>T å¯ä»¥è°ƒç”¨T()çš„æ–¹æ³•ï¼Œå› ä¸ºæŒ‡é’ˆå¯ä»¥è§£å¼•ç”¨ã€‚</em></span></div><h4 id=-go-sliceæ˜¯æ€ä¹ˆæ‰©å®¹çš„>ğŸ† go sliceæ˜¯æ€ä¹ˆæ‰©å®¹çš„ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹</summary><p>Go &lt;= 1.17</p><p>å¦‚æœå½“å‰å®¹é‡å°äº1024ï¼Œåˆ™åˆ¤æ–­æ‰€éœ€å®¹é‡æ˜¯å¦å¤§äºåŸæ¥å®¹é‡2å€ï¼Œå¦‚æœå¤§äºï¼Œå½“å‰å®¹é‡åŠ ä¸Šæ‰€éœ€å®¹é‡ï¼›å¦åˆ™å½“å‰å®¹é‡ä¹˜2ã€‚</p><p>å¦‚æœå½“å‰å®¹é‡å¤§äº1024ï¼Œåˆ™æ¯æ¬¡æŒ‰ç…§1.25å€é€Ÿåº¦é€’å¢å®¹é‡ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡åŠ ä¸Šcap/4ã€‚</p><p>Go1.18ä¹‹åï¼Œå¼•å…¥äº†æ–°çš„æ‰©å®¹è§„åˆ™ï¼š<a href=https://www.lookcos.cn/archives/1204.html target=_blank rel="external nofollow noopener noreferrer">æµ…è°ˆ Go 1.18.1çš„åˆ‡ç‰‡æ‰©å®¹æœºåˆ¶<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></details><h4 id=-æ— ç¼“å†²çš„-channel-å’Œæœ‰ç¼“å†²çš„-channel-çš„åŒºåˆ«>ğŸ¥” æ— ç¼“å†²çš„ channel å’Œæœ‰ç¼“å†²çš„ channel çš„åŒºåˆ«ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹</summary><p><strong>å¯¹äºæ— ç¼“å†²åŒºchannelï¼š</strong></p><p>å‘é€çš„æ•°æ®å¦‚æœæ²¡æœ‰è¢«æ¥æ”¶æ–¹æ¥æ”¶ï¼Œé‚£ä¹ˆå‘é€æ–¹é˜»å¡ï¼›å¦‚æœä¸€ç›´æ¥æ”¶ä¸åˆ°å‘é€æ–¹çš„æ•°æ®ï¼Œæ¥æ”¶æ–¹é˜»å¡ï¼›</p><p><strong>æœ‰ç¼“å†²çš„channelï¼š</strong></p><p>å‘é€æ–¹åœ¨ç¼“å†²åŒºæ»¡çš„æ—¶å€™é˜»å¡ï¼Œæ¥æ”¶æ–¹ä¸é˜»å¡ï¼›æ¥æ”¶æ–¹åœ¨ç¼“å†²åŒºä¸ºç©ºçš„æ—¶å€™é˜»å¡ï¼Œå‘é€æ–¹ä¸é˜»å¡ã€‚</p></details><h4 id=-ä¸ºä»€ä¹ˆæœ‰åç¨‹æ³„éœ²goroutine-leak>ğŸ¥• ä¸ºä»€ä¹ˆæœ‰åç¨‹æ³„éœ²(Goroutine Leak)ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹</summary><p><em>åç¨‹æ³„æ¼æ˜¯æŒ‡åç¨‹åˆ›å»ºä¹‹åæ²¡æœ‰å¾—åˆ°é‡Šæ”¾ã€‚ä¸»è¦åŸå› æœ‰ï¼š</em></p><ol><li>ç¼ºå°‘æ¥æ”¶å™¨ï¼Œå¯¼è‡´å‘é€é˜»å¡</li><li>ç¼ºå°‘å‘é€å™¨ï¼Œå¯¼è‡´æ¥æ”¶é˜»å¡</li><li>æ­»é”ã€‚å¤šä¸ªåç¨‹ç”±äºç«äº‰èµ„æºå¯¼è‡´æ­»é”ã€‚</li><li>åˆ›å»ºåç¨‹çš„æ²¡æœ‰å›æ”¶ã€‚</li></ol></details><h4 id=-go-å¯ä»¥é™åˆ¶è¿è¡Œæ—¶æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„æ•°é‡å—-å¸¸è§çš„goroutineæ“ä½œå‡½æ•°æœ‰å“ªäº›>ğŸŒ½ Go å¯ä»¥é™åˆ¶è¿è¡Œæ—¶æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„æ•°é‡å—ï¼Ÿ å¸¸è§çš„goroutineæ“ä½œå‡½æ•°æœ‰å“ªäº›ï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>å¯ä»¥ï¼Œä½¿ç”¨runtime.GOMAXPROCS(num int)å¯ä»¥è®¾ç½®çº¿ç¨‹æ•°ç›®ã€‚è¯¥å€¼é»˜è®¤ä¸ºCPUé€»è¾‘æ ¸æ•°ï¼Œå¦‚æœè®¾çš„å¤ªå¤§ï¼Œä¼šå¼•èµ·é¢‘ç¹çš„çº¿ç¨‹åˆ‡æ¢ï¼Œé™ä½æ€§èƒ½ã€‚</em></span></div><h4 id=-å¦‚ä½•æ§åˆ¶åç¨‹æ•°ç›®>ğŸŒ¶ï¸ å¦‚ä½•æ§åˆ¶åç¨‹æ•°ç›®ã€‚</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>GOMAXPROCS é™åˆ¶çš„æ˜¯åŒæ—¶æ‰§è¡Œç”¨æˆ·æ€ Go ä»£ç çš„æ“ä½œç³»ç»Ÿçº¿ç¨‹çš„æ•°é‡ï¼Œä½†æ˜¯å¯¹äºè¢«ç³»ç»Ÿè°ƒç”¨é˜»å¡çš„çº¿ç¨‹æ•°é‡æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚</em></span></div><h4 id=-newå’Œmakeçš„åŒºåˆ«>ğŸ¥’ newå’Œmakeçš„åŒºåˆ«ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><ol><li><em>newåªç”¨äºåˆ†é…å†…å­˜ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘åœ°å€çš„æŒ‡é’ˆã€‚å®ƒä¸ºæ¯ä¸ªæ–°ç±»å‹åˆ†é…ä¸€ç‰‡å†…å­˜ï¼Œåˆå§‹åŒ–ä¸º0ä¸”è¿”å›ç±»å‹*Tçš„å†…å­˜åœ°å€ï¼Œå®ƒç›¸å½“äº&T{}</em></li><li><em>makeåªå¯ç”¨äºslice,map,channelçš„åˆå§‹åŒ–,è¿”å›çš„æ˜¯å¼•ç”¨ã€‚</em></li></ol></details><h4 id=-è¯·ä½ è®²ä¸€ä¸‹goé¢å‘å¯¹è±¡æ˜¯å¦‚ä½•å®ç°çš„>ğŸ¥¬ è¯·ä½ è®²ä¸€ä¸‹Goé¢å‘å¯¹è±¡æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>Goå®ç°é¢å‘å¯¹è±¡çš„ä¸¤ä¸ªå…³é”®æ˜¯structå’Œinterfaceã€‚</em></p><p><em>å°è£…ï¼šå¯¹äºåŒä¸€ä¸ªåŒ…ï¼Œå¯¹è±¡å¯¹åŒ…å†…çš„æ–‡ä»¶å¯è§ï¼›å¯¹ä¸åŒçš„åŒ…ï¼Œéœ€è¦å°†å¯¹è±¡ä»¥å¤§å†™å¼€å¤´æ‰æ˜¯å¯è§çš„ã€‚</em></p><p><em>ç»§æ‰¿ï¼šç»§æ‰¿æ˜¯ç¼–è¯‘æ—¶ç‰¹å¾ï¼Œåœ¨structå†…åŠ å…¥æ‰€éœ€è¦ç»§æ‰¿çš„ç±»å³å¯ï¼š</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>A</span> <span class=kd>struct</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>B</span> <span class=kd>struct</span><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>A</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><em>å¤šæ€ï¼šå¤šæ€æ˜¯è¿è¡Œæ—¶ç‰¹å¾ï¼ŒGoå¤šæ€é€šè¿‡interfaceæ¥å®ç°ã€‚ç±»å‹å’Œæ¥å£æ˜¯æ¾è€¦åˆçš„ï¼ŒæŸä¸ªç±»å‹çš„å®ä¾‹å¯ä»¥èµ‹ç»™å®ƒæ‰€å®ç°çš„ä»»æ„æ¥å£ç±»å‹çš„å˜é‡ã€‚</em></p><p><strong>Goæ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œå°±æ˜¯åœ¨ç±»å‹ä¸­åµŒå…¥æ‰€æœ‰å¿…è¦çš„çˆ¶ç±»å‹ã€‚</strong></p></details><h4 id=-init-å‡½æ•°>ğŸ¥¦ init å‡½æ•°</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>goçš„initå‡½æ•°åœ¨mainå‡½æ•°ä¹‹å‰æ‰§è¡Œ</em></p><p><strong>initå‡½æ•°çš„ç‰¹ç‚¹ï¼š</strong></p><ol><li>åˆå§‹åŒ–ä¸èƒ½é‡‡ç”¨åˆå§‹åŒ–è¡¨è¾¾å¼åˆå§‹åŒ–çš„å˜é‡ï¼›</li><li>ç¨‹åºè¿è¡Œå‰æ‰§è¡Œæ³¨å†Œ</li><li>å®ç°sync.OnceåŠŸèƒ½</li><li>ä¸èƒ½è¢«å…¶å®ƒå‡½æ•°è°ƒç”¨</li><li>initå‡½æ•°æ²¡æœ‰å…¥å£å‚æ•°å’Œè¿”å›å€¼ï¼š</li><li>æ¯ä¸ªåŒ…å¯ä»¥æœ‰å¤šä¸ªinitå‡½æ•°ï¼Œæ¯ä¸ªæºæ–‡ä»¶ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªinitå‡½æ•°ã€‚</li><li>åŒä¸€ä¸ªåŒ…çš„initæ‰§è¡Œé¡ºåºï¼Œgolangæ²¡æœ‰æ˜ç¡®å®šä¹‰ï¼Œç¼–ç¨‹æ—¶è¦æ³¨æ„ç¨‹åºä¸è¦ä¾èµ–è¿™ä¸ªæ‰§è¡Œé¡ºåºã€‚</li><li>ä¸åŒåŒ…çš„initå‡½æ•°æŒ‰ç…§åŒ…å¯¼å…¥çš„ä¾èµ–å…³ç³»å†³å®šæ‰§è¡Œé¡ºåºã€‚</li></ol></details><h4 id=-ä¸‹é¢è¿™å¥ä»£ç æ˜¯ä»€ä¹ˆä½œç”¨ä¸ºä»€ä¹ˆè¦å®šä¹‰ä¸€ä¸ªç©ºå€¼>ğŸ„ ä¸‹é¢è¿™å¥ä»£ç æ˜¯ä»€ä¹ˆä½œç”¨ï¼Œä¸ºä»€ä¹ˆè¦å®šä¹‰ä¸€ä¸ªç©ºå€¼ï¼Ÿ</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>GobCodec</span> <span class=kd>struct</span><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>conn</span> <span class=nx>io</span><span class=p>.</span><span class=nx>ReadWriteCloser</span>
</span></span><span class=line><span class=cl>	<span class=nx>buf</span> <span class=o>*</span><span class=nx>bufio</span><span class=p>.</span><span class=nx>Writer</span>
</span></span><span class=line><span class=cl>	<span class=nx>dec</span> <span class=o>*</span><span class=nx>gob</span><span class=p>.</span><span class=nx>Decoder</span>
</span></span><span class=line><span class=cl>	<span class=nx>enc</span> <span class=o>*</span><span class=nx>gob</span><span class=p>.</span><span class=nx>Encoder</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Codec</span> <span class=kd>interface</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>io</span><span class=p>.</span><span class=nx>Closer</span>
</span></span><span class=line><span class=cl>	<span class=nf>ReadHeader</span><span class=p>(</span><span class=o>*</span><span class=nx>Header</span><span class=p>)</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>	<span class=nf>ReadBody</span><span class=p>(</span><span class=kd>interface</span><span class=p>{})</span>  <span class=kt>error</span>
</span></span><span class=line><span class=cl>	<span class=nf>Write</span><span class=p>(</span><span class=o>*</span><span class=nx>Header</span><span class=p>,</span> <span class=kd>interface</span><span class=p>{})</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>_</span> <span class=nx>Codec</span> <span class=p>=</span> <span class=p>(</span><span class=o>*</span><span class=nx>GobCodec</span><span class=p>)(</span><span class=kc>nil</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>ç­”ï¼šå°†nilè½¬æ¢ä¸º</em>GobCodecç±»å‹ï¼Œç„¶åå†è½¬æ¢ä¸ºCodecæ¥å£ï¼Œå¦‚æœè½¬æ¢å¤±è´¥ï¼Œè¯´æ˜<em>GobCodecæ²¡æœ‰å®ç°Codecæ¥å£çš„æ‰€æœ‰æ–¹æ³•ã€‚</em></span></div><h4 id=-golangçš„å†…å­˜ç®¡ç†çš„åŸç†æ¸…æ¥šå—ç®€è¿°goå†…å­˜ç®¡ç†æœºåˆ¶>ğŸŒ° golangçš„å†…å­˜ç®¡ç†çš„åŸç†æ¸…æ¥šå—ï¼Ÿç®€è¿°goå†…å­˜ç®¡ç†æœºåˆ¶ã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>golangå†…å­˜ç®¡ç†åŸºæœ¬æ˜¯å‚è€ƒtcmallocæ¥è¿›è¡Œçš„ã€‚goå†…å­˜ç®¡ç†æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå†…å­˜æ± ï¼Œåªä¸è¿‡å†…éƒ¨åšäº†å¾ˆå¤šä¼˜åŒ–ï¼šè‡ªåŠ¨ä¼¸ç¼©å†…å­˜æ± å¤§å°ï¼Œåˆç†çš„åˆ‡å‰²å†…å­˜å—ã€‚</em></p><blockquote><p>ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼šé¡µPageï¼šä¸€å—8Kå¤§å°çš„å†…å­˜ç©ºé—´ã€‚Goå‘æ“ä½œç³»ç»Ÿç”³è¯·å’Œé‡Šæ”¾å†…å­˜éƒ½æ˜¯ä»¥é¡µä¸ºå•ä½çš„ã€‚span : å†…å­˜å—ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªè¿ç»­çš„ page ç»„æˆä¸€ä¸ª span ã€‚å¦‚æœæŠŠ page æ¯”å–»æˆå·¥äººï¼Œ span å¯çœ‹æˆæ˜¯å°é˜Ÿï¼Œå·¥äººè¢«åˆ†æˆè‹¥å¹²ä¸ªé˜Ÿä¼ï¼Œä¸åŒçš„é˜Ÿä¼å¹²ä¸åŒçš„æ´»ã€‚sizeclass : ç©ºé—´è§„æ ¼ï¼Œæ¯ä¸ª span éƒ½å¸¦æœ‰ä¸€ä¸ª sizeclass ï¼Œæ ‡è®°ç€è¯¥ span ä¸­çš„ page åº”è¯¥å¦‚ä½•ä½¿ç”¨ã€‚ä½¿ç”¨ä¸Šé¢çš„æ¯”å–»ï¼Œå°±æ˜¯ sizeclass æ ‡å¿—ç€ span æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„é˜Ÿä¼ã€‚object : å¯¹è±¡ï¼Œç”¨æ¥å­˜å‚¨ä¸€ä¸ªå˜é‡æ•°æ®å†…å­˜ç©ºé—´ï¼Œä¸€ä¸ª span åœ¨åˆå§‹åŒ–æ—¶ï¼Œä¼šè¢«åˆ‡å‰²æˆä¸€å †ç­‰å¤§çš„ object ã€‚å‡è®¾ object çš„å¤§å°æ˜¯ 16B ï¼Œ span å¤§å°æ˜¯ 8K ï¼Œé‚£ä¹ˆå°±ä¼šæŠŠ span ä¸­çš„ page å°±ä¼šè¢«åˆå§‹åŒ– 8K / 16B = 512 ä¸ª object ã€‚æ‰€è°“å†…å­˜åˆ†é…ï¼Œå°±æ˜¯åˆ†é…ä¸€ä¸ª object å‡ºå»ã€‚</p></blockquote><p><strong>mheap</strong></p><p><em>ä¸€å¼€å§‹goä»æ“ä½œç³»ç»Ÿç´¢å–ä¸€å¤§å—å†…å­˜ä½œä¸ºå†…å­˜æ± ï¼Œå¹¶æ”¾åœ¨ä¸€ä¸ªå«mheapçš„å†…å­˜æ± è¿›è¡Œç®¡ç†ï¼Œmheapå°†ä¸€æ•´å—å†…å­˜åˆ‡å‰²ä¸ºä¸åŒçš„åŒºåŸŸï¼Œå¹¶å°†ä¸€éƒ¨åˆ†å†…å­˜åˆ‡å‰²ä¸ºåˆé€‚çš„å¤§å°ã€‚</em></p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/mhead.jpg data-srcset="/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/mhead.jpg, /posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/mhead.jpg 1.5x, /posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/mhead.jpg 2x" data-sizes=auto alt=mheadå†…å­˜æ±  title=mheadå†…å­˜æ± ></p><p><strong>mcentral</strong></p><p><em>ç”¨é€”ç›¸åŒçš„spanä¼šä»¥é“¾è¡¨çš„å½¢å¼ç»„ç»‡åœ¨ä¸€èµ·å­˜æ”¾åœ¨mcentralä¸­ã€‚è¿™é‡Œç”¨é€”ç”¨sizeclassæ¥è¡¨ç¤ºï¼Œå°±æ˜¯è¯¥spanå­˜å‚¨å“ªç§å¤§å°çš„å¯¹è±¡ã€‚</em></p><p><em>æ‰¾åˆ°åˆé€‚çš„ span åï¼Œä¼šä»ä¸­å–ä¸€ä¸ª object è¿”å›ç»™ä¸Šå±‚ä½¿ç”¨ã€‚</em></p><p><strong>mcache</strong></p><p><em>ä¸ºäº†æé«˜å†…å­˜å¹¶å‘ç”³è¯·æ•ˆç‡ï¼ŒåŠ å…¥ç¼“å­˜å±‚mcacheã€‚æ¯ä¸€ä¸ªmcacheå’Œå¤„ç†å™¨På¯¹åº”ã€‚Goç”³è¯·å†…å­˜é¦–å…ˆä»Pçš„mcacheä¸­åˆ†é…ï¼Œå¦‚æœæ²¡æœ‰å¯ç”¨çš„spanå†ä»mcentralä¸­è·å–ã€‚</em></p><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href=https://cloud.tencent.com/developer/article/1422392 target=_blank rel="external nofollow noopener noreferrer">Go è¯­è¨€å†…å­˜ç®¡ç†ï¼ˆäºŒï¼‰ï¼šGo å†…å­˜ç®¡ç†<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-mutexæœ‰å‡ ç§æ¨¡å¼>ğŸ«‘ mutexæœ‰å‡ ç§æ¨¡å¼ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>mutexæœ‰ä¸¤ç§æ¨¡å¼ï¼šnormal å’Œ starvation</em></p><p><strong>æ­£å¸¸æ¨¡å¼</strong></p><p><em>æ‰€æœ‰goroutineæŒ‰ç…§FIFOçš„é¡ºåºè¿›è¡Œé”è·å–ï¼Œè¢«å”¤é†’çš„goroutineå’Œæ–°è¯·æ±‚é”çš„goroutineåŒæ—¶è¿›è¡Œé”è·å–ï¼Œé€šå¸¸æ–°è¯·æ±‚é”çš„goroutineæ›´å®¹æ˜“è·å–é”(æŒç»­å æœ‰cpu)ï¼Œè¢«å”¤é†’çš„goroutineåˆ™ä¸å®¹æ˜“è·å–åˆ°é”ã€‚å…¬å¹³æ€§ï¼šå¦ã€‚</em></p><p><strong>é¥¥é¥¿æ¨¡å¼</strong></p><p><em>æ‰€æœ‰å°è¯•è·å–é”çš„goroutineè¿›è¡Œç­‰å¾…æ’é˜Ÿï¼Œæ–°è¯·æ±‚é”çš„goroutineä¸ä¼šè¿›è¡Œé”è·å–(ç¦ç”¨è‡ªæ—‹)ï¼Œè€Œæ˜¯åŠ å…¥é˜Ÿåˆ—å°¾éƒ¨ç­‰å¾…è·å–é”ã€‚å…¬å¹³æ€§ï¼šæ˜¯ã€‚</em></p><blockquote><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/baolingye/article/details/111357407#:~:text=%E6%AF%8F%E4%B8%AAMutex%E9%83%BD,tarving%E3%80%82" target=_blank rel="external nofollow noopener noreferrer">Go Mutex é¥¥é¥¿æ¨¡å¼ï¼ŒGO äº’æ–¥é”ï¼ˆMutexï¼‰åŸç†<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-goå¦‚ä½•è¿›è¡Œè°ƒåº¦çš„gmpä¸­çŠ¶æ€æµè½¬>ğŸ goå¦‚ä½•è¿›è¡Œè°ƒåº¦çš„ã€‚GMPä¸­çŠ¶æ€æµè½¬ã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>Goé‡Œé¢GMPåˆ†åˆ«ä»£è¡¨ï¼šGï¼šgoroutineï¼ŒMï¼šçº¿ç¨‹ï¼ˆçœŸæ­£åœ¨CPUä¸Šè·‘çš„ï¼‰ï¼ŒPï¼šè°ƒåº¦å™¨ã€‚</em></p><figure><img src=/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/GMP%e6%a8%a1%e5%9e%8b.jpg><figcaption><h4>GMPæ¨¡å‹</h4></figcaption></figure><p><em>è°ƒåº¦å™¨æ˜¯Må’ŒGä¹‹é—´æ¡¥æ¢ã€‚</em></p><p><strong>goè¿›è¡Œè°ƒåº¦è¿‡ç¨‹ï¼š</strong></p><ol><li>æŸä¸ªçº¿ç¨‹å°è¯•åˆ›å»ºä¸€ä¸ªæ–°çš„Gï¼Œé‚£ä¹ˆè¿™ä¸ªGå°±ä¼šè¢«å®‰æ’åˆ°è¿™ä¸ªçº¿ç¨‹çš„Gæœ¬åœ°é˜Ÿåˆ—LRQä¸­ï¼Œå¦‚æœLRQæ»¡äº†ï¼Œå°±ä¼šåˆ†é…åˆ°å…¨å±€é˜Ÿåˆ—GRQä¸­ï¼›</li><li>å°è¯•è·å–å½“å‰çº¿ç¨‹çš„Mï¼Œå¦‚æœæ— æ³•è·å–ï¼Œå°±ä¼šä»ç©ºé—²çš„Måˆ—è¡¨ä¸­æ‰¾ä¸€ä¸ªï¼Œå¦‚æœç©ºé—²åˆ—è¡¨ä¹Ÿæ²¡æœ‰ï¼Œé‚£ä¹ˆå°±åˆ›å»ºä¸€ä¸ªMï¼Œç„¶åç»‘å®šGä¸Pè¿è¡Œã€‚</li><li>è¿›å…¥è°ƒåº¦å¾ªç¯ï¼š<ol><li>æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„G</li><li>æ‰§è¡ŒGï¼Œå®Œæˆä»¥åé€€å‡º</li></ol></li></ol></details><h4 id=-goä»€ä¹ˆæ—¶å€™å‘ç”Ÿé˜»å¡é˜»å¡æ—¶è°ƒåº¦å™¨ä¼šæ€ä¹ˆåš>ğŸ¥– Goä»€ä¹ˆæ—¶å€™å‘ç”Ÿé˜»å¡ï¼Ÿé˜»å¡æ—¶ï¼Œè°ƒåº¦å™¨ä¼šæ€ä¹ˆåšã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><ol><li>ç”¨äºåŸå­ã€äº’æ–¥é‡æˆ–é€šé“æ“ä½œå¯¼è‡´goroutineé˜»å¡ï¼Œè°ƒåº¦å™¨å°†æŠŠå½“å‰é˜»å¡çš„goroutineä»æœ¬åœ°è¿è¡Œé˜Ÿåˆ—LRQæ¢å‡ºï¼Œå¹¶é‡æ–°è°ƒåº¦å…¶å®ƒgoroutineï¼›</li><li>ç”±äºç½‘ç»œè¯·æ±‚å’ŒIOå¯¼è‡´çš„é˜»å¡ï¼ŒGoæä¾›äº†ç½‘ç»œè½®è¯¢å™¨ï¼ˆNetpollerï¼‰æ¥å¤„ç†ï¼Œåå°ç”¨epollç­‰æŠ€æœ¯å®ç°IOå¤šè·¯å¤ç”¨ã€‚</li></ol><blockquote><p>æ›´å¤šå…³äºnetpollerçš„å†…å®¹å¯ä»¥å‚çœ‹ï¼š<a href=https://strikefreedom.top/archives/go-netpoll-io-multiplexing-reactor target=_blank rel="external nofollow noopener noreferrer">https://strikefreedom.top/archives/go-netpoll-io-multiplexing-reactor<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-goä¸­gmpæœ‰å“ªäº›çŠ¶æ€>ğŸ¥¨ Goä¸­GMPæœ‰å“ªäº›çŠ¶æ€ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><figure><img src=/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/GMP%e7%8a%b6%e6%80%81.jpg><figcaption><h4>GMPçŠ¶æ€</h4></figcaption></figure><p><strong>Gçš„çŠ¶æ€ï¼š</strong></p><p>_Gidleï¼šåˆšåˆšè¢«åˆ†é…å¹¶ä¸”è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå€¼ä¸º0ï¼Œä¸ºåˆ›å»ºgoroutineåçš„é»˜è®¤å€¼</p><p>_Grunnableï¼š æ²¡æœ‰æ‰§è¡Œä»£ç ï¼Œæ²¡æœ‰æ ˆçš„æ‰€æœ‰æƒï¼Œå­˜å‚¨åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œå¯èƒ½åœ¨æŸä¸ªPçš„æœ¬åœ°é˜Ÿåˆ—æˆ–å…¨å±€é˜Ÿåˆ—ä¸­(å¦‚ä¸Šå›¾)ã€‚</p><p>_Grunningï¼š æ­£åœ¨æ‰§è¡Œä»£ç çš„goroutineï¼Œæ‹¥æœ‰æ ˆçš„æ‰€æœ‰æƒ(å¦‚ä¸Šå›¾)ã€‚</p><p>_Gsyscallï¼šæ­£åœ¨æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œæ‹¥æœ‰æ ˆçš„æ‰€æœ‰æƒï¼Œä¸Pè„±ç¦»ï¼Œä½†æ˜¯ä¸æŸä¸ªMç»‘å®šï¼Œä¼šåœ¨è°ƒç”¨ç»“æŸåè¢«åˆ†é…åˆ°è¿è¡Œé˜Ÿåˆ—(å¦‚ä¸Šå›¾)ã€‚</p><p>_Gwaitingï¼šè¢«é˜»å¡çš„goroutineï¼Œé˜»å¡åœ¨æŸä¸ªchannelçš„å‘é€æˆ–è€…æ¥æ”¶é˜Ÿåˆ—(å¦‚ä¸Šå›¾)ã€‚</p><p>_Gdeadï¼š å½“å‰goroutineæœªè¢«ä½¿ç”¨ï¼Œæ²¡æœ‰æ‰§è¡Œä»£ç ï¼Œå¯èƒ½æœ‰åˆ†é…çš„æ ˆï¼Œåˆ†å¸ƒåœ¨ç©ºé—²åˆ—è¡¨gFreeï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªåˆšåˆšåˆå§‹åŒ–çš„goroutineï¼Œä¹Ÿå¯èƒ½æ˜¯æ‰§è¡Œäº†goexité€€å‡ºçš„goroutine(å¦‚ä¸Šå›¾)ã€‚</p><p>_Gcopystacï¼šæ ˆæ­£åœ¨è¢«æ‹·è´ï¼Œæ²¡æœ‰æ‰§è¡Œä»£ç ï¼Œä¸åœ¨è¿è¡Œé˜Ÿåˆ—ä¸Šï¼Œæ‰§è¡Œæƒåœ¨</p><p>_Gscan ï¼š GC æ­£åœ¨æ‰«ææ ˆç©ºé—´ï¼Œæ²¡æœ‰æ‰§è¡Œä»£ç ï¼Œå¯ä»¥ä¸å…¶ä»–çŠ¶æ€åŒæ—¶å­˜åœ¨ã€‚</p><p><strong>Pçš„çŠ¶æ€ï¼š</strong></p><p>_Pidle ï¼šå¤„ç†å™¨æ²¡æœ‰è¿è¡Œç”¨æˆ·ä»£ç æˆ–è€…è°ƒåº¦å™¨ï¼Œè¢«ç©ºé—²é˜Ÿåˆ—æˆ–è€…æ”¹å˜å…¶çŠ¶æ€çš„ç»“æ„æŒæœ‰ï¼Œè¿è¡Œé˜Ÿåˆ—ä¸ºç©º</p><p>_Prunning ï¼šè¢«çº¿ç¨‹ M æŒæœ‰ï¼Œå¹¶ä¸”æ­£åœ¨æ‰§è¡Œç”¨æˆ·ä»£ç æˆ–è€…è°ƒåº¦å™¨(å¦‚ä¸Šå›¾)</p><p>_Psyscallï¼šæ²¡æœ‰æ‰§è¡Œç”¨æˆ·ä»£ç ï¼Œå½“å‰çº¿ç¨‹é™·å…¥ç³»ç»Ÿè°ƒç”¨(å¦‚ä¸Šå›¾)</p><p>_Pgcstop ï¼šè¢«çº¿ç¨‹ M æŒæœ‰ï¼Œå½“å‰å¤„ç†å™¨ç”±äºåƒåœ¾å›æ”¶è¢«åœæ­¢</p><p>_Pdead ï¼šå½“å‰å¤„ç†å™¨å·²ç»ä¸è¢«ä½¿ç”¨</p><p><strong>Mçš„çŠ¶æ€ï¼š</strong></p><p>è‡ªæ—‹çº¿ç¨‹ï¼šå¤„äºè¿è¡ŒçŠ¶æ€ä½†æ˜¯æ²¡æœ‰å¯æ‰§è¡Œgoroutineçš„çº¿ç¨‹ï¼Œæ•°é‡æœ€å¤šä¸ºGOMAXPROCï¼Œè‹¥æ˜¯æ•°é‡å¤§äºGOMAXPROCå°±ä¼šè¿›å…¥ä¼‘çœ ã€‚</p><p>éè‡ªæ—‹çº¿ç¨‹ï¼šå¤„äºè¿è¡ŒçŠ¶æ€æœ‰å¯æ‰§è¡Œgoroutineçš„çº¿ç¨‹ã€‚</p></details><h4 id=-gmpèƒ½ä¸èƒ½å»æ‰på±‚ä¼šæ€ä¹ˆæ ·>ğŸ¥¯ GMPèƒ½ä¸èƒ½å»æ‰På±‚ï¼Ÿä¼šæ€ä¹ˆæ ·ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><strong>På±‚çš„ä½œç”¨</strong></p><ol><li>æ¯ä¸ª P æœ‰è‡ªå·±çš„æœ¬åœ°é˜Ÿåˆ—ï¼Œå¤§å¹…åº¦çš„å‡è½»äº†å¯¹å…¨å±€é˜Ÿåˆ—çš„ç›´æ¥ä¾èµ–ï¼Œæ‰€å¸¦æ¥çš„æ•ˆæœå°±æ˜¯é”ç«äº‰çš„å‡å°‘ã€‚è€Œ GM æ¨¡å‹çš„æ€§èƒ½å¼€é”€å¤§å¤´å°±æ˜¯é”ç«äº‰ã€‚</li><li>æ¯ä¸ª P ç›¸å¯¹çš„å¹³è¡¡ä¸Šï¼Œåœ¨ GMP æ¨¡å‹ä¸­ä¹Ÿå®ç°äº† Work Stealing ç®—æ³•ï¼Œå¦‚æœ P çš„æœ¬åœ°é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™ä¼šä»å…¨å±€é˜Ÿåˆ—æˆ–å…¶ä»– P çš„æœ¬åœ°é˜Ÿåˆ—ä¸­çªƒå–å¯è¿è¡Œçš„ G æ¥è¿è¡Œï¼Œå‡å°‘ç©ºè½¬ï¼Œæé«˜äº†èµ„æºåˆ©ç”¨ç‡ã€‚</li></ol><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href=https://juejin.cn/post/6968311281220583454 target=_blank rel="external nofollow noopener noreferrer">https://juejin.cn/post/6968311281220583454<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-å¦‚æœæœ‰ä¸€ä¸ªgä¸€ç›´å ç”¨èµ„æºæ€ä¹ˆåŠä»€ä¹ˆæ˜¯work-stealingç®—æ³•>ğŸ§€ å¦‚æœæœ‰ä¸€ä¸ªGä¸€ç›´å ç”¨èµ„æºæ€ä¹ˆåŠï¼Ÿä»€ä¹ˆæ˜¯work stealingç®—æ³•ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>å¦‚æœæœ‰ä¸ªgoroutineä¸€ç›´å ç”¨èµ„æºï¼Œé‚£ä¹ˆGMPæ¨¡å‹ä¼šä»æ­£å¸¸æ¨¡å¼è½¬å˜ä¸ºé¥¥é¥¿æ¨¡å¼ï¼ˆç±»ä¼¼äºmutexï¼‰ï¼Œå…è®¸å…¶å®ƒgoroutineä½¿ç”¨work stealingæŠ¢å ï¼ˆç¦ç”¨è‡ªæ—‹é”ï¼‰ã€‚</em></p><p><em>work stealingç®—æ³•æŒ‡ï¼Œä¸€ä¸ªçº¿ç¨‹å¦‚æœå¤„äºç©ºé—²çŠ¶æ€ï¼Œåˆ™å¸®å…¶å®ƒæ­£åœ¨å¿™çš„çº¿ç¨‹åˆ†æ‹…å‹åŠ›ï¼Œä»å…¨å±€é˜Ÿåˆ—å–ä¸€ä¸ªGä»»åŠ¡æ¥æ‰§è¡Œï¼Œå¯ä»¥æå¤§æé«˜æ‰§è¡Œæ•ˆç‡ã€‚</em></p></details><h4 id=-goroutineä»€ä¹ˆæƒ…å†µä¼šå‘ç”Ÿå†…å­˜æ³„æ¼å¦‚ä½•é¿å…>ğŸ– goroutineä»€ä¹ˆæƒ…å†µä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ï¼Ÿå¦‚ä½•é¿å…ã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>åœ¨Goä¸­å†…å­˜æ³„éœ²åˆ†ä¸ºæš‚æ—¶æ€§å†…å­˜æ³„éœ²å’Œæ°¸ä¹…æ€§å†…å­˜æ³„éœ²ã€‚</em></p><p><strong>æš‚æ—¶æ€§å†…å­˜æ³„éœ²</strong></p><ol><li>è·å–é•¿å­—ç¬¦ä¸²ä¸­çš„ä¸€æ®µå¯¼è‡´é•¿å­—ç¬¦ä¸²æœªé‡Šæ”¾</li><li>è·å–é•¿sliceä¸­çš„ä¸€æ®µå¯¼è‡´é•¿sliceæœªé‡Šæ”¾</li><li>åœ¨é•¿sliceæ–°å»ºsliceå¯¼è‡´æ³„æ¼</li></ol><p><em>stringç›¸æ¯”åˆ‡ç‰‡å°‘äº†ä¸€ä¸ªå®¹é‡çš„capå­—æ®µï¼Œå¯ä»¥æŠŠstringå½“æˆä¸€ä¸ªåªè¯»çš„åˆ‡ç‰‡ç±»å‹ã€‚è·å–é•¿stringæˆ–è€…åˆ‡ç‰‡ä¸­çš„ä¸€æ®µå†…å®¹ï¼Œç”±äºæ–°ç”Ÿæˆçš„å¯¹è±¡å’Œè€çš„stringæˆ–è€…åˆ‡ç‰‡å…±ç”¨ä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œä¼šå¯¼è‡´è€çš„stringå’Œåˆ‡ç‰‡èµ„æºæš‚æ—¶å¾—ä¸åˆ°é‡Šæ”¾ï¼Œé€ æˆçŸ­æš‚çš„å†…å­˜æ³„æ¼</em></p><p><strong>æ°¸ä¹…æ€§å†…å­˜æ³„éœ²</strong></p><ol><li>goroutineæ°¸ä¹…é˜»å¡è€Œå¯¼è‡´æ³„æ¼</li><li>time.Tickeræœªå…³é—­å¯¼è‡´æ³„æ¼</li><li>ä¸æ­£ç¡®ä½¿ç”¨Finalizerï¼ˆGoç‰ˆæœ¬çš„ææ„å‡½æ•°ï¼‰å¯¼è‡´æ³„æ¼</li></ol></details><h4 id=-go-gcæœ‰å‡ ä¸ªé˜¶æ®µ>ğŸ— Go GCæœ‰å‡ ä¸ªé˜¶æ®µ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>ç›®å‰çš„go GCé‡‡ç”¨ä¸‰è‰²æ ‡è®°æ³•å’Œæ··åˆå†™å±éšœæŠ€æœ¯ã€‚</em></p><p><strong>Go GCæœ‰å››ä¸ªé˜¶æ®µ:</strong></p><ol><li>STWï¼Œå¼€å¯æ··åˆå†™å±éšœï¼Œæ‰«ææ ˆå¯¹è±¡ï¼›</li><li>å°†æ‰€æœ‰å¯¹è±¡åŠ å…¥ç™½è‰²é›†åˆï¼Œä»æ ¹å¯¹è±¡å¼€å§‹ï¼Œå°†å…¶æ”¾å…¥ç°è‰²é›†åˆã€‚æ¯æ¬¡ä»ç°è‰²é›†åˆå–å‡ºä¸€ä¸ªå¯¹è±¡æ ‡è®°ä¸ºé»‘è‰²ï¼Œç„¶åéå†å…¶å­å¯¹è±¡ï¼Œæ ‡è®°ä¸ºç°è‰²ï¼Œæ”¾å…¥ç°è‰²é›†åˆï¼›</li><li>å¦‚æ­¤å¾ªç¯ç›´åˆ°ç°è‰²é›†åˆä¸ºç©ºã€‚å‰©ä½™çš„ç™½è‰²å¯¹è±¡å°±æ˜¯éœ€è¦æ¸…ç†çš„å¯¹è±¡ã€‚</li><li>STWï¼Œå…³é—­æ··åˆå†™å±éšœï¼›</li><li>åœ¨åå°è¿›è¡ŒGCï¼ˆå¹¶å‘ï¼‰ã€‚</li></ol></details><h4 id=-goç«æ€æ¡ä»¶äº†è§£å—>ğŸ¥© goç«æ€æ¡ä»¶äº†è§£å—ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>æ‰€è°“ç«æ€ç«äº‰ï¼Œå°±æ˜¯å½“ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„goroutineè®¿é—®ç›¸åŒèµ„æºæ—¶å€™ï¼Œå¯¹èµ„æºè¿›è¡Œè¯»/å†™ã€‚</em></p><p>æ¯”å¦‚var a int = 0ï¼Œæœ‰ä¸¤ä¸ªåç¨‹åˆ†åˆ«å¯¹a+=1ï¼Œæˆ‘ä»¬å‘ç°æœ€åaä¸ä¸€å®šä¸º2.è¿™å°±æ˜¯ç«æ€ç«äº‰ã€‚</p><p>é€šå¸¸æˆ‘ä»¬å¯ä»¥ç”¨go run -race xx.goæ¥è¿›è¡Œæ£€æµ‹ã€‚</p><p>è§£å†³æ–¹æ³•æ˜¯ï¼Œå¯¹ä¸´ç•ŒåŒºèµ„æºä¸Šé”ï¼Œæˆ–è€…ä½¿ç”¨åŸå­æ“ä½œ(atomics)ï¼ŒåŸå­æ“ä½œçš„å¼€é”€å°äºä¸Šé”ã€‚</p></details><h4 id=-å¦‚æœè‹¥å¹²ä¸ªgoroutineæœ‰ä¸€ä¸ªpanicä¼šæ€ä¹ˆåš>ğŸ¥“ å¦‚æœè‹¥å¹²ä¸ªgoroutineï¼Œæœ‰ä¸€ä¸ªpanicä¼šæ€ä¹ˆåšï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>æœ‰ä¸€ä¸ªpanicï¼Œé‚£ä¹ˆå‰©ä½™goroutineä¹Ÿä¼šé€€å‡ºï¼Œç¨‹åºé€€å‡ºã€‚å¦‚æœä¸æƒ³ç¨‹åºé€€å‡ºï¼Œé‚£ä¹ˆå¿…é¡»é€šè¿‡è°ƒç”¨ recover() æ–¹æ³•æ¥æ•è· panic å¹¶æ¢å¤å°†è¦å´©æ‰çš„ç¨‹åº</em></p><blockquote><p>å‚è€ƒç†è§£ï¼š<a href=https://blog.csdn.net/huorongbj/article/details/123013273 target=_blank rel="external nofollow noopener noreferrer">goroutineé…ä¸Španicä¼šæ€æ ·<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>ã€‚</p></blockquote></details><h4 id=-deferå¯ä»¥æ•è·goroutineçš„å­goroutineå—>ğŸ” deferå¯ä»¥æ•è·goroutineçš„å­goroutineå—ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>ä¸å¯ä»¥ã€‚å®ƒä»¬å¤„äºä¸åŒçš„è°ƒåº¦å™¨Pä¸­ã€‚å¯¹äºå­goroutineï¼Œå¿…é¡»é€šè¿‡ recover() æœºåˆ¶æ¥è¿›è¡Œæ¢å¤ï¼Œç„¶åç»“åˆæ—¥å¿—è¿›è¡Œæ‰“å°ï¼ˆæˆ–è€…é€šè¿‡channelä¼ é€’errorï¼‰</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// å¿ƒè·³å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>Ping</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span> <span class=nx>code</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=nx>r</span> <span class=o>:=</span> <span class=nb>recover</span><span class=p>();</span> <span class=nx>r</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>log</span><span class=p>.</span><span class=nf>Errorc</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span> <span class=s>&#34;ping panic: %v, stack: %v&#34;</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=nb>string</span><span class=p>(</span><span class=nx>debug</span><span class=p>.</span><span class=nf>Stack</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>}()</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>        <span class=o>...</span> <span class=nx>code</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>	<span class=p>}()</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=o>...</span> <span class=nx>code</span> <span class=o>...</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h4 id=-grpcæ˜¯ä»€ä¹ˆ>ğŸŸ gRPCæ˜¯ä»€ä¹ˆï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>åŸºäºgoçš„è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ã€‚RPC æ¡†æ¶çš„ç›®æ ‡å°±æ˜¯è®©è¿œç¨‹æœåŠ¡è°ƒç”¨æ›´åŠ ç®€å•ã€é€æ˜ï¼ŒRPC æ¡†æ¶è´Ÿè´£å±è”½åº•å±‚çš„ä¼ è¾“æ–¹å¼ï¼ˆTCP æˆ–è€… UDPï¼‰ã€åºåˆ—åŒ–æ–¹å¼ï¼ˆXML/Json/ äºŒè¿›åˆ¶ï¼‰å’Œé€šä¿¡ç»†èŠ‚ã€‚æœåŠ¡è°ƒç”¨è€…å¯ä»¥åƒè°ƒç”¨æœ¬åœ°æ¥å£ä¸€æ ·è°ƒç”¨è¿œç¨‹çš„æœåŠ¡æä¾›è€…ï¼Œè€Œä¸éœ€è¦å…³å¿ƒåº•å±‚é€šä¿¡ç»†èŠ‚å’Œè°ƒç”¨è¿‡ç¨‹ã€‚</em></p><figure><img src=/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/gRPC%e6%a1%86%e6%9e%b6%e5%9b%be.jpg><figcaption><h4>gRPCæ¡†æ¶å›¾</h4></figcaption></figure></details><h4 id=-å¾®æœåŠ¡äº†è§£å—>ğŸ• å¾®æœåŠ¡äº†è§£å—ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>å¾®æœåŠ¡æ˜¯ä¸€ç§å¼€å‘è½¯ä»¶çš„æ¶æ„å’Œç»„ç»‡æ–¹æ³•ï¼Œå…¶ä¸­è½¯ä»¶ç”±é€šè¿‡æ˜ç¡®å®šä¹‰çš„ API è¿›è¡Œé€šä¿¡çš„å°å‹ç‹¬ç«‹æœåŠ¡ç»„æˆã€‚å¾®æœåŠ¡æ¶æ„ä½¿åº”ç”¨ç¨‹åºæ›´æ˜“äºæ‰©å±•å’Œæ›´å¿«åœ°å¼€å‘ï¼Œä»è€ŒåŠ é€Ÿåˆ›æ–°å¹¶ç¼©çŸ­æ–°åŠŸèƒ½çš„ä¸Šå¸‚æ—¶é—´ã€‚</em></p><figure><img src=/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/%e5%be%ae%e6%9c%8d%e5%8a%a1%e7%a4%ba%e6%84%8f%e5%9b%be.jpg><figcaption><h4>å¾®æœåŠ¡ç¤ºæ„å›¾</h4></figcaption></figure><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href=https://aws.amazon.com/cn/microservices/ target=_blank rel="external nofollow noopener noreferrer">ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ| AWS<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-æœåŠ¡å‘ç°æ˜¯æ€ä¹ˆåšçš„>ğŸŒ­ æœåŠ¡å‘ç°æ˜¯æ€ä¹ˆåšçš„ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>ä¸»è¦æœ‰ä¸¤ç§æœåŠ¡å‘ç°æœºåˆ¶ï¼šå®¢æˆ·ç«¯å‘ç°å’ŒæœåŠ¡ç«¯å‘ç°ã€‚</em></p><p>**å®¢æˆ·ç«¯å‘ç°æ¨¡å¼ï¼š**å½“æˆ‘ä»¬ä½¿ç”¨å®¢æˆ·ç«¯å‘ç°çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯è´Ÿè´£å†³å®šå¯ç”¨æœåŠ¡å®ä¾‹çš„ç½‘ç»œåœ°å€å¹¶ä¸”åœ¨é›†ç¾¤ä¸­å¯¹è¯·æ±‚è´Ÿè½½å‡è¡¡, å®¢æˆ·ç«¯è®¿é—®æœåŠ¡ç™»è®°è¡¨ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå¯ç”¨æœåŠ¡çš„æ•°æ®åº“ï¼Œç„¶åå®¢æˆ·ç«¯ä½¿ç”¨ä¸€ç§è´Ÿè½½å‡è¡¡ç®—æ³•é€‰æ‹©ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡å®ä¾‹ç„¶åå‘èµ·è¯·æ±‚</p><figure><img src=/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/%e5%ae%a2%e6%88%b7%e7%ab%af%e5%8f%91%e7%8e%b0%e6%a8%a1%e5%bc%8f.jpg><figcaption><h4>å®¢æˆ·ç«¯å‘ç°æ¨¡å¼</h4></figcaption></figure><p>**æœåŠ¡ç«¯å‘ç°æ¨¡å¼ï¼š**å®¢æˆ·ç«¯é€šè¿‡è´Ÿè½½å‡è¡¡å™¨å‘æŸä¸ªæœåŠ¡æå‡ºè¯·æ±‚ï¼Œè´Ÿè½½å‡è¡¡å™¨æŸ¥è¯¢æœåŠ¡æ³¨å†Œè¡¨ï¼Œå¹¶å°†è¯·æ±‚è½¬å‘åˆ°å¯ç”¨çš„æœåŠ¡å®ä¾‹ã€‚å¦‚åŒå®¢æˆ·ç«¯å‘ç°ï¼ŒæœåŠ¡å®ä¾‹åœ¨æœåŠ¡æ³¨å†Œè¡¨ä¸­æ³¨å†Œæˆ–æ³¨é”€ã€‚</p><figure><img src=/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/%e6%9c%8d%e5%8a%a1%e7%ab%af%e5%8f%91%e7%8e%b0%e6%a8%a1%e5%bc%8f.jpg><figcaption><h4>æœåŠ¡çš„å‘ç°æ¨¡å¼</h4></figcaption></figure><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href=http://blog.daocloud.io/3289.html target=_blank rel="external nofollow noopener noreferrer">ã€ŒChris Richardson å¾®æœåŠ¡ç³»åˆ—ã€æœåŠ¡å‘ç°çš„å¯è¡Œæ–¹æ¡ˆä»¥åŠå®è·µæ¡ˆä¾‹<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-etcdç”¨è¿‡å—>ğŸ¥ª ETCDç”¨è¿‡å—ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p>etcdæ˜¯ä¸€ä¸ªé«˜åº¦ä¸€è‡´çš„åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œå®ƒæä¾›äº†ä¸€ç§å¯é çš„æ–¹å¼æ¥å­˜å‚¨éœ€è¦ç”±åˆ†å¸ƒå¼ç³»ç»Ÿæˆ–æœºå™¨é›†ç¾¤è®¿é—®çš„æ•°æ®ã€‚å®ƒå¯ä»¥ä¼˜é›…åœ°å¤„ç†ç½‘ç»œåˆ†åŒºæœŸé—´çš„é¢†å¯¼è€…é€‰ä¸¾ï¼Œå³ä½¿åœ¨é¢†å¯¼è€…èŠ‚ç‚¹ä¸­ä¹Ÿå¯ä»¥å®¹å¿æœºå™¨æ•…éšœã€‚</p><p>etcd æ˜¯ç”¨Goè¯­è¨€ç¼–å†™çš„ï¼Œå®ƒå…·æœ‰å‡ºè‰²çš„è·¨å¹³å°æ”¯æŒï¼Œå°çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œå¼ºå¤§çš„ç¤¾åŒºã€‚etcdæœºå™¨ä¹‹é—´çš„é€šä¿¡é€šè¿‡Raftå…±è¯†ç®—æ³•å¤„ç†ã€‚</p><blockquote><p>å…³äºæ–‡æ¡£å¯ä»¥å‚è€ƒï¼š<a href=https://etcd.io/docs/v3.5/ target=_blank rel="external nofollow noopener noreferrer">v3.5 docs<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-ginæ€ä¹ˆåšå‚æ•°æ ¡éªŒ>ğŸŒ® GINæ€ä¹ˆåšå‚æ•°æ ¡éªŒï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>goé‡‡ç”¨validatorä½œå‚æ•°æ ¡éªŒã€‚</em></p><ol><li>ä½¿ç”¨éªŒè¯tagæˆ–è‡ªå®šä¹‰validatorè¿›è¡Œè·¨å­—æ®µFieldå’Œè·¨ç»“æ„ä½“éªŒè¯ã€‚</li><li>å…è®¸åˆ‡ç‰‡ã€æ•°ç»„å’Œå“ˆå¸Œè¡¨ï¼Œå¤šç»´å­—æ®µçš„ä»»ä½•æˆ–æ‰€æœ‰çº§åˆ«è¿›è¡Œæ ¡éªŒã€‚</li><li>èƒ½å¤Ÿå¯¹å“ˆå¸Œè¡¨keyå’Œvalueè¿›è¡ŒéªŒè¯</li><li>é€šè¿‡åœ¨éªŒè¯ä¹‹å‰ç¡®å®šå®ƒçš„åŸºç¡€ç±»å‹æ¥å¤„ç†ç±»å‹æ¥å£ã€‚</li><li>åˆ«åéªŒè¯æ ‡ç­¾ï¼Œå…è®¸å°†å¤šä¸ªéªŒè¯æ˜ å°„åˆ°å•ä¸ªæ ‡ç­¾ï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°å®šä¹‰ç»“æ„ä½“ä¸Šçš„éªŒè¯</li><li>gin web æ¡†æ¶çš„é»˜è®¤éªŒè¯å™¨ï¼›</li></ol><p>å‚è€ƒèµ„æ–™ï¼š<a href=https://pkg.go.dev/github.com/go-playground/validator#section-readme target=_blank rel="external nofollow noopener noreferrer">validator package - pkg.go.dev<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></details><h4 id=-ä¸­é—´ä»¶ç”¨è¿‡å—>ğŸŒ¯ ä¸­é—´ä»¶ç”¨è¿‡å—ï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>Middlewareæ˜¯Webçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸­é—´ä»¶ï¼ˆé€šå¸¸ï¼‰æ˜¯ä¸€å°æ®µä»£ç ï¼Œå®ƒä»¬æ¥å—ä¸€ä¸ªè¯·æ±‚ï¼Œå¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œæ¯ä¸ªä¸­é—´ä»¶åªå¤„ç†ä¸€ä»¶äº‹æƒ…ï¼Œå®Œæˆåå°†å…¶ä¼ é€’ç»™å¦ä¸€ä¸ªä¸­é—´ä»¶æˆ–æœ€ç»ˆå¤„ç†ç¨‹åºï¼Œè¿™æ ·å°±åšåˆ°äº†ç¨‹åºçš„è§£è€¦ã€‚</em></span></div><h4 id=-goè§£ætagæ˜¯æ€ä¹ˆå®ç°çš„>ğŸ¥™ Goè§£æTagæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>Goè§£ætagé‡‡ç”¨çš„æ˜¯åå°„ã€‚</em></p><p>å…·ä½“æ¥è¯´ä½¿ç”¨reflect.ValueOfæ–¹æ³•è·å–å…¶åå°„å€¼ï¼Œç„¶åè·å–å…¶Typeå±æ€§ï¼Œä¹‹åå†é€šè¿‡Field(i)è·å–ç¬¬i+1ä¸ªfieldï¼Œå†.Tagè·å¾—Tagã€‚</p><p>åå°„å®ç°çš„åŸç†åœ¨: <code>src/reflect/type.go</code>ä¸­</p></details><h4 id=-ä½ é¡¹ç›®æœ‰ä¼˜é›…çš„å¯åœå—>ğŸ² ä½ é¡¹ç›®æœ‰ä¼˜é›…çš„å¯åœå—ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p>æ‰€è°“ã€Œä¼˜é›…ã€å¯åœå°±æ˜¯åœ¨å¯åŠ¨é€€å‡ºæœåŠ¡æ—¶è¦æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š</p><ol><li>ä¸å¯ä»¥å…³é—­ç°æœ‰è¿æ¥ï¼ˆè¿›ç¨‹ï¼‰</li><li>æ–°çš„è¿›ç¨‹å¯åŠ¨å¹¶ã€Œæ¥ç®¡ã€æ—§è¿›ç¨‹</li><li>è¿æ¥è¦éšæ—¶å“åº”ç”¨æˆ·è¯·æ±‚ï¼Œä¸å¯ä»¥å‡ºç°æ‹’ç»è¯·æ±‚çš„æƒ…å†µ</li><li>åœæ­¢çš„æ—¶å€™ï¼Œå¿…é¡»å¤„ç†å®Œæ—¢æœ‰è¿æ¥ï¼Œå¹¶ä¸”åœæ­¢æ¥æ”¶æ–°çš„è¿æ¥ã€‚</li></ol><p><em><strong>ä¸ºæ­¤æˆ‘ä»¬å¿…é¡»å¼•ç”¨ä¿¡å·æ¥å®Œæˆè¿™äº›ç›®çš„ï¼š</strong></em></p><p>å¯åŠ¨ï¼š</p><ol><li>ç›‘å¬SIGHUPï¼ˆåœ¨ç”¨æˆ·ç»ˆç«¯è¿æ¥(æ­£å¸¸æˆ–éæ­£å¸¸)ç»“æŸæ—¶å‘å‡ºï¼‰ï¼›</li><li>æ”¶åˆ°ä¿¡å·åå°†æœåŠ¡ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦ä¼ é€’ç»™æ–°çš„å­è¿›ç¨‹ï¼Œæ­¤æ—¶æ–°è€è¿›ç¨‹åŒæ—¶æ¥æ”¶è¯·æ±‚ï¼›</li></ol><p>é€€å‡º</p><ol><li>ç›‘å¬SIGINTå’ŒSIGSTPå’ŒSIGQUITç­‰ã€‚</li><li>çˆ¶è¿›ç¨‹åœæ­¢æ¥æ”¶æ–°è¯·æ±‚ï¼Œç­‰å¾…æ—§è¯·æ±‚å®Œæˆï¼ˆæˆ–è¶…æ—¶ï¼‰ï¼›</li><li>çˆ¶è¿›ç¨‹é€€å‡ºã€‚</li></ol><p><em>å®ç°ï¼šgo1.8é‡‡ç”¨Http.Serverå†…ç½®çš„Shutdownæ–¹æ³•æ”¯æŒä¼˜é›…å…³æœºã€‚ ç„¶åfvbock/endlesså¯ä»¥å®ç°ä¼˜é›…é‡å¯ã€‚</em></p><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href=https://juejin.cn/post/6867074626427502600#heading-3 target=_blank rel="external nofollow noopener noreferrer">ginæ¡†æ¶å®è·µè¿è½½å…« | å¦‚ä½•ä¼˜é›…é‡å¯å’Œåœæ­¢ - æ˜é‡‘<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>ï¼Œ<a href=http://www.phpxs.com/post/7186/ target=_blank rel="external nofollow noopener noreferrer">ä¼˜é›…åœ°å…³é—­æˆ–é‡å¯ go web é¡¹ç›®<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-æŒä¹…åŒ–æ€ä¹ˆåšçš„>ğŸ¥— æŒä¹…åŒ–æ€ä¹ˆåšçš„ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>æ‰€è°“æŒä¹…åŒ–å°±æ˜¯å°†è¦ä¿å­˜çš„å­—ç¬¦ä¸²å†™åˆ°ç¡¬ç›˜ç­‰è®¾å¤‡ã€‚</em></p><ol><li>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯é‡‡ç”¨ioutilçš„WriteFile()æ–¹æ³•å°†å­—ç¬¦ä¸²å†™åˆ°ç£ç›˜ä¸Šï¼Œè¿™ç§æ–¹æ³•é¢ä¸´æ ¼å¼åŒ–æ–¹é¢çš„é—®é¢˜ã€‚</li><li>æ›´å¥½çš„åšæ³•æ˜¯å°†æ•°æ®æŒ‰ç…§å›ºå®šåè®®è¿›è¡Œç»„ç»‡å†è¿›è¡Œè¯»å†™ï¼Œæ¯”å¦‚JSONï¼ŒXMLï¼ŒGobï¼Œcsvç­‰ã€‚</li><li>å¦‚æœè¦è€ƒè™‘é«˜å¹¶å‘å’Œé«˜å¯ç”¨ï¼Œå¿…é¡»æŠŠæ•°æ®æ”¾å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œæ¯”å¦‚MySQLï¼ŒPostgreDBï¼ŒMongoDBç­‰ã€‚</li></ol><blockquote><p>å‚è€ƒé“¾æ¥ï¼š<a href=https://www.jianshu.com/p/015aca3e11ae target=_blank rel="external nofollow noopener noreferrer">Golang æŒä¹…åŒ–<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-channel-æ­»é”çš„åœºæ™¯>ğŸ¿ channel æ­»é”çš„åœºæ™¯</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><ul><li><em>å½“ä¸€ä¸ªchannelä¸­æ²¡æœ‰æ•°æ®ï¼Œè€Œç›´æ¥è¯»å–æ—¶ï¼Œä¼šå‘ç”Ÿæ­»é”ï¼š</em></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>q</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>&lt;-</span><span class=nx>q</span>
</span></span></code></pre></td></tr></table></div></div><p><em>è§£å†³æ–¹æ¡ˆæ˜¯é‡‡ç”¨selectè¯­å¥ï¼Œå†defaultæ”¾é»˜è®¤å¤„ç†æ–¹å¼ï¼š</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>q</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>select</span><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=k>case</span> <span class=nx>val</span><span class=o>:=&lt;-</span><span class=nx>q</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>         <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><em>å½“channelæ•°æ®æ»¡äº†ï¼Œå†å°è¯•å†™æ•°æ®ä¼šé€ æˆæ­»é”ï¼š</em></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>q</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>q</span><span class=o>&lt;-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=nx>q</span><span class=o>&lt;-</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=nx>q</span><span class=o>&lt;-</span><span class=mi>3</span>
</span></span></code></pre></td></tr></table></div></div><p><em>è§£å†³æ–¹æ³•ï¼Œé‡‡ç”¨select</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>q</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>q</span> <span class=o>&lt;-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>	<span class=nx>q</span> <span class=o>&lt;-</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>	<span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>case</span> <span class=nx>q</span> <span class=o>&lt;-</span> <span class=mi>3</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;ok&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;wrong&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><em>å‘ä¸€ä¸ªå…³é—­çš„channelå†™æ•°æ®ã€‚</em></li></ul><p>æ³¨æ„ï¼šä¸€ä¸ªå·²ç»å…³é—­çš„channelï¼Œåªèƒ½è¯»æ•°æ®ï¼Œä¸èƒ½å†™æ•°æ®ã€‚</p><p>å‚è€ƒèµ„æ–™ï¼š<a href=https://blog.csdn.net/qq_35976351/article/details/81984117 target=_blank rel="external nofollow noopener noreferrer">Golangå…³äºchannelæ­»é”æƒ…å†µçš„æ±‡æ€»ä»¥åŠè§£å†³æ–¹æ¡ˆ<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></details><h4 id=-å¯¹å·²ç»å…³é—­çš„chanè¿›è¡Œè¯»å†™ä¼šæ€ä¹ˆæ ·>ğŸ¥« å¯¹å·²ç»å…³é—­çš„chanè¿›è¡Œè¯»å†™ä¼šæ€ä¹ˆæ ·ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><ol><li>è¯»å·²ç»å…³é—­çš„chanèƒ½ä¸€ç›´è¯»åˆ°ä¸œè¥¿ï¼Œä½†æ˜¯è¯»åˆ°çš„å†…å®¹æ ¹æ®é€šé“å†…å…³é—­å‰æ˜¯å¦æœ‰å…ƒç´ è€Œä¸åŒã€‚<ol><li>å¦‚æœchanå…³é—­å‰ï¼Œbufferå†…æœ‰å…ƒç´ è¿˜æœªè¯»,ä¼šæ­£ç¡®è¯»åˆ°chanå†…çš„å€¼ï¼Œä¸”è¿”å›çš„ç¬¬äºŒä¸ªboolå€¼ï¼ˆæ˜¯å¦è¯»æˆåŠŸï¼‰ä¸ºtrueã€‚</li><li>å¦‚æœchanå…³é—­å‰ï¼Œbufferå†…æœ‰å…ƒç´ å·²ç»è¢«è¯»å®Œï¼Œchanå†…æ— å€¼ï¼Œæ¥ä¸‹æ¥æ‰€æœ‰æ¥æ”¶çš„å€¼éƒ½ä¼šéé˜»å¡ç›´æ¥æˆåŠŸï¼Œè¿”å› channel å…ƒç´ çš„é›¶å€¼ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªboolå€¼ä¸€ç›´ä¸ºfalseã€‚</li></ol></li></ol><p>å†™å·²ç»å…³é—­çš„chanä¼španicã€‚</details><h4 id=-è¯´è¯´-atomicåº•å±‚æ€ä¹ˆå®ç°çš„>ğŸ± è¯´è¯´ atomicåº•å±‚æ€ä¹ˆå®ç°çš„.</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>atomicæºç ä½äº<code>sync\atomic</code>ã€‚é€šè¿‡é˜…è¯»æºç å¯çŸ¥ï¼Œatomicé‡‡ç”¨CASï¼ˆCompareAndSwapï¼‰çš„æ–¹å¼å®ç°çš„ã€‚æ‰€è°“CASå°±æ˜¯ä½¿ç”¨äº†CPUä¸­çš„åŸå­æ€§æ“ä½œã€‚åœ¨æ“ä½œå…±äº«å˜é‡çš„æ—¶å€™ï¼ŒCASä¸éœ€è¦å¯¹å…¶è¿›è¡ŒåŠ é”ï¼Œè€Œæ˜¯é€šè¿‡ç±»ä¼¼äºä¹è§‚é”çš„æ–¹å¼è¿›è¡Œæ£€æµ‹ï¼Œæ€»æ˜¯å‡è®¾è¢«æ“ä½œçš„å€¼æœªæ›¾æ”¹å˜ï¼ˆå³ä¸æ—§å€¼ç›¸ç­‰ï¼‰ï¼Œå¹¶ä¸€æ—¦ç¡®è®¤è¿™ä¸ªå‡è®¾çš„çœŸå®æ€§å°±ç«‹å³è¿›è¡Œå€¼æ›¿æ¢ã€‚æœ¬è´¨ä¸Šæ˜¯ä¸æ–­å ç”¨CPUèµ„æºæ¥é¿å…åŠ é”çš„å¼€é”€ã€‚</em></p><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href=https://www.programminghunter.com/article/37392193442/ target=_blank rel="external nofollow noopener noreferrer">Goè¯­è¨€çš„åŸå­æ“ä½œatomic - ç¼–ç¨‹çŒäºº<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-channelåº•å±‚å®ç°æ˜¯å¦çº¿ç¨‹å®‰å…¨>ğŸ˜ channelåº•å±‚å®ç°ï¼Ÿæ˜¯å¦çº¿ç¨‹å®‰å…¨ã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>channelåº•å±‚å®ç°åœ¨src/runtime/chan.goä¸­</em></p><p><em>channelå†…éƒ¨æ˜¯ä¸€ä¸ªå¾ªç¯é“¾è¡¨ã€‚å†…éƒ¨åŒ…å«buf, sendx, recvx, lock ,recvq, sendqå‡ ä¸ªéƒ¨åˆ†ï¼›</em></p><p><strong>bufæ˜¯æœ‰ç¼“å†²çš„channelæ‰€ç‰¹æœ‰çš„ç»“æ„ï¼Œç”¨æ¥å­˜å‚¨ç¼“å­˜æ•°æ®ã€‚æ˜¯ä¸ªå¾ªç¯é“¾è¡¨ï¼›</strong></p><ol><li>sendxå’Œrecvxç”¨äºè®°å½•bufè¿™ä¸ªå¾ªç¯é“¾è¡¨ä¸­çš„å‘é€æˆ–è€…æ¥æ”¶çš„indexï¼›</li><li>lockæ˜¯ä¸ªäº’æ–¥é”ï¼›</li><li>recvqå’Œsendqåˆ†åˆ«æ˜¯æ¥æ”¶(&lt;-channel)æˆ–è€…å‘é€(channel &lt;- xxx)çš„goroutineæŠ½è±¡å‡ºæ¥çš„ç»“æ„ä½“(sudog)çš„é˜Ÿåˆ—ã€‚æ˜¯ä¸ªåŒå‘é“¾è¡¨ã€‚</li></ol><p><em>channelæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</em></p><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href=https://zhuanlan.zhihu.com/p/264305133 target=_blank rel="external nofollow noopener noreferrer">Kitouï¼šGolang æ·±åº¦å‰–æ &ndash; channelçš„åº•å±‚å®ç°<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-mapçš„åº•å±‚å®ç°>ğŸš mapçš„åº•å±‚å®ç°ã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>æºç ä½äºsrc\runtime\map.go ä¸­ã€‚</em></p><p><em>goçš„mapå’ŒC++mapä¸ä¸€æ ·ï¼Œåº•å±‚å®ç°æ˜¯å“ˆå¸Œè¡¨ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šhmapå’Œbucketã€‚</em></p><p><strong>é‡Œé¢æœ€é‡è¦çš„æ˜¯bucketsï¼ˆæ¡¶ï¼‰ï¼Œbucketsæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæœ€ç»ˆå®ƒæŒ‡å‘çš„æ˜¯ä¸€ä¸ªç»“æ„ä½“</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// A bucket for a Go map.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>type</span> <span class=nx>bmap</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>tophash</span> <span class=p>[</span><span class=nx>bucketCnt</span><span class=p>]</span><span class=kt>uint8</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¯ä¸ªbucketå›ºå®šåŒ…å«8ä¸ªkeyå’Œvalue(å¯ä»¥æŸ¥çœ‹æºç bucketCnt=8).å®ç°ä¸Šé¢æ˜¯ä¸€ä¸ªå›ºå®šçš„å¤§å°è¿ç»­å†…å­˜å—ï¼Œåˆ†æˆå››éƒ¨åˆ†ï¼šæ¯ä¸ªæ¡ç›®çš„çŠ¶æ€ï¼Œ8ä¸ªkeyå€¼ï¼Œ8ä¸ªvalueå€¼ï¼ŒæŒ‡å‘ä¸‹ä¸ªbucketçš„æŒ‡é’ˆã€‚</p><p>åˆ›å»ºå“ˆå¸Œè¡¨ä½¿ç”¨çš„æ˜¯makemapå‡½æ•°.map çš„ä¸€ä¸ªå…³é”®ç‚¹åœ¨äºï¼Œå“ˆå¸Œå‡½æ•°çš„é€‰æ‹©ã€‚åœ¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œä¼šæ£€æµ‹ cpu æ˜¯å¦æ”¯æŒ aesï¼Œå¦‚æœæ”¯æŒï¼Œåˆ™ä½¿ç”¨ aes hashï¼Œå¦åˆ™ä½¿ç”¨ memhashã€‚è¿™æ˜¯åœ¨å‡½æ•° alginit() ä¸­å®Œæˆï¼Œä½äºè·¯å¾„ï¼šsrc/runtime/alg.go ä¸‹ã€‚</p><p>mapæŸ¥æ‰¾å°±æ˜¯å°†keyå“ˆå¸Œåå¾—åˆ°64ä½ï¼ˆ64ä½æœºï¼‰ç”¨æœ€åBä¸ªæ¯”ç‰¹ä½è®¡ç®—åœ¨å“ªä¸ªæ¡¶ã€‚åœ¨ bucket ä¸­ï¼Œä»å‰å¾€åæ‰¾åˆ°ç¬¬ä¸€ä¸ªç©ºä½ã€‚è¿™æ ·ï¼Œåœ¨æŸ¥æ‰¾æŸä¸ª key æ—¶ï¼Œå…ˆæ‰¾åˆ°å¯¹åº”çš„æ¡¶ï¼Œå†å»éå† bucket ä¸­çš„ keyã€‚</p><blockquote><p>å…³äºmapçš„æŸ¥æ‰¾å’Œæ‰©å®¹å¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/chenxun_2010/article/details/103768011?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0.pc_relevant_aa&spm=1001.2101.3001.4242.1&utm_relevant_index=3" target=_blank rel="external nofollow noopener noreferrer">mapçš„ç”¨æ³•åˆ°mapåº•å±‚å®ç°åˆ†æã€‚<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-selectçš„å®ç°åŸç†>ğŸ› selectçš„å®ç°åŸç†ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><strong>selectæºç ä½äºsrc\runtime\select.goï¼Œæœ€é‡è¦çš„scase æ•°æ®ç»“æ„ä¸ºï¼š</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>scase</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>c</span>    <span class=o>*</span><span class=nx>hchan</span>         <span class=c1>// chan
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>elem</span> <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span> <span class=c1>// data element
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><em>scase.cä¸ºå½“å‰caseè¯­å¥æ‰€æ“ä½œçš„channelæŒ‡é’ˆï¼Œè¿™ä¹Ÿè¯´æ˜äº†ä¸€ä¸ªcaseè¯­å¥åªèƒ½æ“ä½œä¸€ä¸ªchannelã€‚</em></p><p><strong>scase.elemè¡¨ç¤ºç¼“å†²åŒºåœ°å€ï¼š</strong></p><ol><li>caseRecv ï¼š scase.elemè¡¨ç¤ºè¯»å‡ºchannelçš„æ•°æ®å­˜æ”¾åœ°å€ï¼›</li><li>caseSend ï¼š scase.elemè¡¨ç¤ºå°†è¦å†™å…¥channelçš„æ•°æ®å­˜æ”¾åœ°å€ï¼›</li></ol><p><strong>selectçš„ä¸»è¦å®ç°ä½äºï¼šselect.goå‡½æ•°ï¼šå…¶ä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š</strong></p><ol><li>é”å®šscaseè¯­å¥ä¸­æ‰€æœ‰çš„channel</li><li>æŒ‰ç…§éšæœºé¡ºåºæ£€æµ‹scaseä¸­çš„channelæ˜¯å¦ready<ol><li>å¦‚æœcaseå¯è¯»ï¼Œåˆ™è¯»å–channelä¸­æ•°æ®ï¼Œè§£é”æ‰€æœ‰çš„channelï¼Œç„¶åè¿”å›(case index, true)</li><li>å¦‚æœcaseå¯å†™ï¼Œåˆ™å°†æ•°æ®å†™å…¥channelï¼Œè§£é”æ‰€æœ‰çš„channelï¼Œç„¶åè¿”å›(case index, false)</li><li>å¦‚æœcaseå¯å†™ï¼Œåˆ™å°†æ•°æ®å†™å…¥channelï¼Œè§£é”æ‰€æœ‰çš„channelï¼Œç„¶åè¿”å›(case index, false)</li></ol></li><li>æ‰€æœ‰caseéƒ½æœªreadyï¼Œä¸”æ²¡æœ‰defaultè¯­å¥<ol><li>å°†å½“å‰åç¨‹åŠ å…¥åˆ°æ‰€æœ‰channelçš„ç­‰å¾…é˜Ÿåˆ—</li><li>å½“å°†åç¨‹è½¬å…¥é˜»å¡ï¼Œç­‰å¾…è¢«å”¤é†’</li></ol></li><li>å”¤é†’åè¿”å›channelå¯¹åº”çš„case index<ol><li>å¦‚æœæ˜¯è¯»æ“ä½œï¼Œè§£é”æ‰€æœ‰çš„channelï¼Œç„¶åè¿”å›(case index, true)</li><li>å¦‚æœæ˜¯å†™æ“ä½œï¼Œè§£é”æ‰€æœ‰çš„channelï¼Œç„¶åè¿”å›(case index, false)</li></ol></li></ol><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href="https://www.cnblogs.com/wuyepeng/p/13910678.html#:~:text=%E4%B8%80%E3%80%81select%E7%AE%80%E4%BB%8B.%201.Go%E7%9A%84select%E8%AF%AD%E5%8F%A5%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BB%85%E8%83%BD%E7%94%A8%E4%BA%8Echannl%E5%8F%91%E9%80%81%E5%92%8C%E6%8E%A5%E6%94%B6%E6%B6%88%E6%81%AF%E7%9A%84%E4%B8%93%E7%94%A8%E8%AF%AD%E5%8F%A5%EF%BC%8C%E6%AD%A4%E8%AF%AD%E5%8F%A5%E8%BF%90%E8%A1%8C%E6%9C%9F%E9%97%B4%E6%98%AF%E9%98%BB%E5%A1%9E%E7%9A%84%EF%BC%9B%E5%BD%93select%E4%B8%AD%E6%B2%A1%E6%9C%89case%E8%AF%AD%E5%8F%A5%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E4%BC%9A%E9%98%BB%E5%A1%9E%E5%BD%93%E5%89%8Dgroutine%E3%80%82.%202.select%E6%98%AFGolang%E5%9C%A8%E8%AF%AD%E8%A8%80%E5%B1%82%E9%9D%A2%E6%8F%90%E4%BE%9B%E7%9A%84I%2FO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E7%9A%84%E6%9C%BA%E5%88%B6%EF%BC%8C%E5%85%B6%E4%B8%93%E9%97%A8%E7%94%A8%E6%9D%A5%E6%A3%80%E6%B5%8B%E5%A4%9A%E4%B8%AAchannel%E6%98%AF%E5%90%A6%E5%87%86%E5%A4%87%E5%AE%8C%E6%AF%95%EF%BC%9A%E5%8F%AF%E8%AF%BB%E6%88%96%E5%8F%AF%E5%86%99%E3%80%82.,3.select%E8%AF%AD%E5%8F%A5%E4%B8%AD%E9%99%A4default%E5%A4%96%EF%BC%8C%E6%AF%8F%E4%B8%AAcase%E6%93%8D%E4%BD%9C%E4%B8%80%E4%B8%AAchannel%EF%BC%8C%E8%A6%81%E4%B9%88%E8%AF%BB%E8%A6%81%E4%B9%88%E5%86%99.%204.select%E8%AF%AD%E5%8F%A5%E4%B8%AD%E9%99%A4default%E5%A4%96%EF%BC%8C%E5%90%84case%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E6%98%AF%E9%9A%8F%E6%9C%BA%E7%9A%84.%205.select%E8%AF%AD%E5%8F%A5%E4%B8%AD%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89default%E8%AF%AD%E5%8F%A5%EF%BC%8C%E5%88%99%E4%BC%9A%E9%98%BB%E5%A1%9E%E7%AD%89%E5%BE%85%E4%BB%BB%E4%B8%80case.%206.select%E8%AF%AD%E5%8F%A5%E4%B8%AD%E8%AF%BB%E6%93%8D%E4%BD%9C%E8%A6%81%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F%E8%AF%BB%E5%8F%96%EF%BC%8C%E5%85%B3%E9%97%AD%E7%9A%84channel%E4%B9%9F%E5%8F%AF%E4%BB%A5%E8%AF%BB%E5%8F%96" target=_blank rel="external nofollow noopener noreferrer">Go selectçš„ä½¿ç”¨å’Œå®ç°åŸç†.<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-goçš„interfaceæ€ä¹ˆå®ç°çš„>ğŸœ goçš„interfaceæ€ä¹ˆå®ç°çš„ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>go interfaceæºç åœ¨runtime\iface.goä¸­ã€‚</em></p><p><em>goçš„æ¥å£ç”±ä¸¤ç§ç±»å‹å®ç°ifaceå’Œefaceã€‚ifaceæ˜¯åŒ…å«æ–¹æ³•çš„æ¥å£ï¼Œè€Œefaceä¸åŒ…å«æ–¹æ³•ã€‚</em></p><p><strong>iface-å¯¹åº”çš„æ•°æ®ç»“æ„æ˜¯ï¼ˆä½äºsrc\runtime\runtime2.goï¼‰ï¼š</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>iface</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>tab</span>  <span class=o>*</span><span class=nx>itab</span>
</span></span><span class=line><span class=cl>	<span class=nx>data</span> <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><em>å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œtabè¡¨ç¤ºæ¥å£çš„å…·ä½“ç»“æ„ç±»å‹ï¼Œè€Œdataæ˜¯æ¥å£çš„å€¼ã€‚</em></p><p><strong>itab:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>itab</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>inter</span> <span class=o>*</span><span class=nx>interfacetype</span> <span class=c1>//æ­¤å±æ€§ç”¨äºå®šä½åˆ°å…·ä½“interface
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>_type</span> <span class=o>*</span><span class=nx>_type</span> <span class=c1>//æ­¤å±æ€§ç”¨äºå®šä½åˆ°å…·ä½“interface
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>hash</span>  <span class=kt>uint32</span> <span class=c1>// copy of _type.hash. Used for type switches.
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>_</span>     <span class=p>[</span><span class=mi>4</span><span class=p>]</span><span class=kt>byte</span>
</span></span><span class=line><span class=cl>	<span class=nx>fun</span>   <span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=kt>uintptr</span> <span class=c1>// variable sized. fun[0]==0 means _type does not implement inter.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å±æ€§interfacetypeç±»ä¼¼äº_typeï¼Œå…¶ä½œç”¨å°±æ˜¯interfaceçš„å…¬å…±æè¿°ï¼Œç±»ä¼¼çš„è¿˜æœ‰maptypeã€arraytypeã€chantypeâ€¦å…¶éƒ½æ˜¯å„ä¸ªç»“æ„çš„å…¬å…±æè¿°ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ç§å¤–åœ¨çš„è¡¨ç°ä¿¡æ¯ã€‚interfaetypeå’Œtypeå”¯ä¸€ç¡®å®šäº†æ¥å£ç±»å‹ï¼Œè€Œhashç”¨äºæŸ¥è¯¢å’Œç±»å‹åˆ¤æ–­ã€‚funè¡¨ç¤ºæ–¹æ³•é›†ã€‚</p><p><strong>eface-ä¸ifaceåŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯ç”¨_typeç›´æ¥è¡¨ç¤ºç±»å‹ï¼Œè¿™æ ·çš„è¯å°±æ— æ³•ä½¿ç”¨æ–¹æ³•ã€‚</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>type</span> <span class=nx>eface</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>_type</span> <span class=o>*</span><span class=nx>_type</span>
</span></span><span class=line><span class=cl>	<span class=nx>data</span>  <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>è¿™é‡Œç¯‡å¹…æœ‰é™ï¼Œæ·±å…¥è®¨è®ºå¯ä»¥çœ‹ï¼š<a href=https://halfrost.com/go_interface/#toc-1 target=_blank rel="external nofollow noopener noreferrer">æ·±å…¥ç ”ç©¶ Go interface åº•å±‚å®ç°<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-goçš„reflect-åº•å±‚å®ç°>ğŸ goçš„reflect åº•å±‚å®ç°</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>go reflectæºç ä½äºsrc\reflect\ä¸‹é¢ï¼Œä½œä¸ºä¸€ä¸ªåº“ç‹¬ç«‹å­˜åœ¨ã€‚åå°„æ˜¯åŸºäºæ¥å£å®ç°çš„ã€‚</em></p><p><strong>Goåå°„æœ‰ä¸‰å¤§æ³•åˆ™ï¼š</strong></p><ol><li>åå°„ä»æ¥å£æ˜ å°„åˆ°åå°„å¯¹è±¡ï¼›</li></ol><figure><img src=/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/%e6%b3%95%e5%88%991.jpg><figcaption><h4>æ³•åˆ™1</h4></figcaption></figure><ol start=2><li>åå°„ä»åå°„å¯¹è±¡æ˜ å°„åˆ°æ¥å£å€¼ï¼›</li></ol><figure><img src=/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/img/%e6%b3%95%e5%88%992.jpg><figcaption><h4>æ³•åˆ™2</h4></figcaption></figure><ol start=3><li>åªæœ‰å€¼å¯ä»¥ä¿®æ”¹(settable)ï¼Œæ‰å¯ä»¥ä¿®æ”¹åå°„å¯¹è±¡ã€‚</li></ol><p><em>Goåå°„åŸºäºä¸Šè¿°ä¸‰ç‚¹å®ç°ã€‚æˆ‘ä»¬å…ˆä»æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªæºæ–‡ä»¶å…¥æ‰‹type.goå’Œvalue.go.</em></p><p><em>typeç”¨äºè·å–å½“å‰å€¼çš„ç±»å‹ã€‚valueç”¨äºè·å–å½“å‰çš„å€¼ã€‚</em></p><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href=https://go.dev/blog/laws-of-reflection target=_blank rel="external nofollow noopener noreferrer">The Laws of Reflection<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>ï¼Œ <a href=https://i6448038.github.io/2020/02/15/golang-reflection/ target=_blank rel="external nofollow noopener noreferrer">å›¾è§£goåå°„å®ç°åŸç†<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-go-gcçš„åŸç†çŸ¥é“å—>ğŸ  go GCçš„åŸç†çŸ¥é“å—ï¼Ÿ</h4><div class=hide-text><span class=check>--æŸ¥çœ‹ç­”æ¡ˆ--</span>
<span class=hide><em>å¦‚æœéœ€è¦ä»æºç è§’åº¦è§£é‡ŠGCï¼Œæ¨èé˜…è¯»ï¼ˆéå¸¸è¯¦ç»†ï¼Œå›¾æ–‡å¹¶èŒ‚ï¼‰ï¼š<a href=https://draveness.me/golang/docs/part3-runtime/ch07-memory/golang-garbage-collector/ target=_blank rel="external nofollow noopener noreferrer">å†…å­˜ç®¡ç†<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></em></span></div><h4 id=-goé‡Œç”¨è¿‡å“ªäº›è®¾è®¡æ¨¡å¼->ğŸ¢ goé‡Œç”¨è¿‡å“ªäº›è®¾è®¡æ¨¡å¼ ?</h4><a href=https://zhuanlan.zhihu.com/p/542596378 target=_blank rel="external nofollow noopener noreferrer" class=card-link><span class=cl-backdrop style=--cl-bg-url:url(/fixit.min.svg)></span>
<span class=cl-content><span class=cl-text><span class=cl-title>Goè®¾è®¡æ¨¡å¼å¸¸è§é¢è¯•é¢˜ã€2022ç‰ˆã€‘</span>
<span class=cl-meta><svg class="cl-icon-link" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M574 665.4c-3.1-3.1-8.2-3.1-11.3.0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2.0-204l116.2-116.2c3.1-3.1 3.1-8.2.0-11.3l-39.8-39.8c-3.1-3.1-8.2-3.1-11.3.0L191.4 526.5c-84.6 84.6-84.6 221.5.0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2.0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6c-3.1 3.1-3.1 8.2.0 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3.0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2.0 204L665.3 562.6c-3.1 3.1-3.1 8.2.0 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3.0l116.2-116.2c84.5-84.6 84.5-221.5.0-306.1z" fill="#a9a9b3"/><path d="M610.1 372.3c-3.1-3.1-8.2-3.1-11.3.0L372.3 598.7c-3.1 3.1-3.1 8.2.0 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3.0l226.4-226.4c3.1-3.1 3.1-8.2.0-11.3l-39.5-39.6z" fill="#a9a9b3"/></svg><span class=cl-url>https://zhuanlan.zhihu.com/p/542596378</span></span></span><svg class="cl-icon-globe" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="64" height="64"><path d="M960 512c0 249.408-203.2 448-448 448-244.778667.0-448-198.592-448-448S262.592 64 512 64s448 198.592 448 448" fill="#2196f3"/><path d="M507.52 718.08c0-8.96-4.48-13.44-13.44-17.92-26.88-8.96-53.76-8.96-76.16-31.381333-4.48-8.96-4.48-17.92-8.96-26.88-8.96-8.96-31.36-13.44-44.8-17.92h-89.6c-13.44-4.48-22.4-22.4-31.36-35.84.0-4.48.0-13.461333-8.96-13.461334-8.96-4.458667-17.92 4.501333-26.88.0-4.48-4.458667-4.48-8.96-4.48-13.418666.0-13.461333 8.96-26.901333 17.92-35.861334 13.44-8.96 26.88 4.48 40.32 4.48 4.48.0 4.48.0 8.96 4.48 13.44 4.48 17.92 22.4 17.92 35.861334v8.96c0 4.48 4.48 4.48 8.96 4.48 4.48-22.4 4.48-44.821333 8.96-67.2.0-26.88 26.88-53.781333 49.28-62.72 8.96-4.458667 13.44 4.501333 22.4.0 26.88-8.96 94.08-35.84 80.64-71.658667-8.96-31.381333-35.84-62.698667-71.68-58.24-8.96 4.501333-13.44 8.96-22.4 13.461333-13.44 8.96-40.32 35.84-53.76 35.84-22.4-4.48-22.4-35.84-17.92-49.301333 4.48-17.92 44.8-76.138667 71.68-67.178667l17.92 17.92c8.96 4.48 22.4 4.48 35.84 4.48 4.48.0 8.96.0 13.44-4.48s4.48-4.48 4.48-8.96c0-13.44-13.44-26.901333-22.4-35.861333s-22.4-17.92-35.84-22.378667c-44.8-13.461333-116.48 4.458667-152.32 35.84-35.84 31.36-62.72 85.12-80.64 129.92-8.96 26.88-17.92 62.698667-22.4 94.08-4.48 22.4-8.96 40.32 4.48 62.698667 13.44 26.88 40.32 53.781333 67.2 71.68 17.92 13.44 53.76 13.44 71.68 35.84 13.44 17.941333 8.96 40.32 8.96 62.72.0 26.88 17.92 49.28 26.88 71.658667C305.92 785.28 310.4 803.2 314.88 816.64c0 4.48 4.48 31.36 4.48 35.84 26.88 13.44 49.28 26.901333 80.64 35.861333 4.48.0 22.4-26.901333 22.4-31.381333 13.44-13.44 22.4-31.36 35.84-40.32 8.96-4.48 17.92-8.96 26.88-17.941333 8.96-8.96 13.44-26.88 17.92-40.32C507.52 749.44 512 731.52 507.52 718.08M516.48 305.92c4.48.0 8.96-4.48 17.92-8.96 13.44-8.96 26.901333-22.4 40.32-31.36 13.461333-8.96 26.901333-22.4 35.861333-31.36 13.44-8.96 22.4-26.88 26.88-40.341333 4.48-8.96 17.941333-26.88 13.44-40.32-4.48-8.96-26.88-13.44-35.84-17.92C579.2 126.698667 547.84 122.24 512 122.24c-13.44.0-31.36 4.458667-35.84 17.92-4.48 22.4 13.44 17.92 31.36 22.4.0.0 4.48 35.84 4.48 40.32 4.48 22.421333-8.96 35.84-8.96 58.24.0 13.44.0 35.84 8.96 44.8h4.48zM892.8 619.52c4.501333-8.96 4.501333-22.4 8.96-31.36 4.501333-22.421333 4.501333-44.8 4.501333-67.2.0-44.8-4.501333-89.578667-17.92-129.92-8.96-13.44-13.461333-26.88-17.941333-40.341333C861.44 328.32 848 305.898667 830.08 288c-17.92-22.4-40.341333-85.12-80.64-67.2-13.44 4.501333-22.4 22.421333-31.36 31.381333l-26.88 40.32c-4.501333 4.48-8.96 13.44-4.501333 17.92.0 4.48 4.501333 4.48 8.96 4.48 8.96 4.501333 13.461333 4.501333 22.421333 8.96 4.48.0 8.96 4.501333 4.48 8.96.0.0.0 4.501333-4.48 4.501334-22.421333 22.4-44.8 40.32-67.2 62.698666-4.48 4.48-8.96 13.44-8.96 17.92s4.48 4.48 4.48 8.96c0 4.501333-4.48 4.501333-8.96 8.96-8.96 4.501333-17.92 8.96-22.4 13.461334-4.48 8.96.0 22.4-4.48 31.36-4.48 22.4-17.941333 40.32-26.901333 62.72-8.96 13.418667-13.418667 26.88-22.378667 40.32.0 17.92-4.501333 31.36 4.458667 44.8 22.421333 31.36 62.72 13.44 94.08 26.901333 8.96 4.458667 17.92 4.458667 22.421333 13.418667C695.658667 682.304 695.658667 704.704 700.16 718.144c4.458667 17.92 8.96 35.84 17.92 53.76 4.48 22.421333 13.44 44.821333 17.92 62.72 40.341333-31.36 76.16-67.178667 103.04-112 26.88-31.424 40.341333-67.242667 53.76-103.104" fill="#cddc39"/></svg></span></a><h4 id=-goçš„è°ƒè¯•åˆ†æå·¥å…·ç”¨è¿‡å“ªäº›>ğŸ£ goçš„è°ƒè¯•/åˆ†æå·¥å…·ç”¨è¿‡å“ªäº›ã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><ol><li>go cover : æµ‹è¯•ä»£ç è¦†ç›–ç‡ï¼›</li><li>godoc: ç”¨äºç”Ÿæˆgoæ–‡æ¡£ï¼›</li><li>pprofï¼šç”¨äºæ€§èƒ½è°ƒä¼˜ï¼Œé’ˆå¯¹cpuï¼Œå†…å­˜å’Œå¹¶å‘ï¼›</li><li>raceï¼šç”¨äºç«äº‰æ£€æµ‹ï¼›</li></ol></details><h4 id=è¿›ç¨‹è¢«killå¦‚ä½•ä¿è¯æ‰€æœ‰goroutineé¡ºåˆ©é€€å‡º>ğŸ¤è¿›ç¨‹è¢«killï¼Œå¦‚ä½•ä¿è¯æ‰€æœ‰goroutineé¡ºåˆ©é€€å‡º</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>goroutineç›‘å¬SIGKILLä¿¡å·ï¼Œä¸€æ—¦æ¥æ”¶åˆ°SIGKILLï¼Œåˆ™ç«‹åˆ»é€€å‡ºã€‚å¯é‡‡ç”¨selectæ–¹æ³•ã€‚</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>var</span> <span class=nx>wg</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>c1</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=nx>os</span><span class=p>.</span><span class=nx>Signal</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>signal</span><span class=p>.</span><span class=nf>Notify</span><span class=p>(</span><span class=nx>c1</span><span class=p>,</span> <span class=nx>syscall</span><span class=p>.</span><span class=nx>SIGINT</span><span class=p>,</span> <span class=nx>syscall</span><span class=p>.</span><span class=nx>SIGTERM</span><span class=p>,</span> <span class=nx>syscall</span><span class=p>.</span><span class=nx>SIGQUIT</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;goroutine 1 receive a signal : %v\n\n&#34;</span><span class=p>,</span> <span class=o>&lt;-</span><span class=nx>c1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;all groutine done!\n&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h4 id=-è¯´è¯´contextåŒ…çš„ä½œç”¨ä½ ç”¨è¿‡å“ªäº›åŸç†çŸ¥é“å—>ğŸ¥ è¯´è¯´contextåŒ…çš„ä½œç”¨ï¼Ÿä½ ç”¨è¿‡å“ªäº›ï¼ŒåŸç†çŸ¥é“å—ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>contextå¯ä»¥ç”¨æ¥åœ¨goroutineä¹‹é—´ä¼ é€’ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç›¸åŒçš„contextå¯ä»¥ä¼ é€’ç»™è¿è¡Œåœ¨ä¸åŒgoroutineä¸­çš„å‡½æ•°ï¼Œä¸Šä¸‹æ–‡å¯¹äºå¤šä¸ªgoroutineåŒæ—¶ä½¿ç”¨æ˜¯å®‰å…¨çš„ï¼ŒcontextåŒ…å®šä¹‰äº†ä¸Šä¸‹æ–‡ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨backgroundã€TODOåˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œåœ¨å‡½æ•°è°ƒç”¨é“¾ä¹‹é—´ä¼ æ’­contextï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨WithDeadlineã€WithTimeoutã€WithCancel æˆ– WithValue åˆ›å»ºçš„ä¿®æ”¹å‰¯æœ¬æ›¿æ¢å®ƒï¼Œå¬èµ·æ¥æœ‰ç‚¹ç»•ï¼Œå…¶å®æ€»ç»“èµ·å°±æ˜¯ä¸€å¥è¯ï¼šcontextçš„ä½œç”¨å°±æ˜¯åœ¨ä¸åŒçš„goroutineä¹‹é—´åŒæ­¥è¯·æ±‚ç‰¹å®šçš„æ•°æ®ã€å–æ¶ˆä¿¡å·ä»¥åŠå¤„ç†è¯·æ±‚çš„æˆªæ­¢æ—¥æœŸã€‚</em></p><blockquote><p>å…³äºcontextåŸç†ï¼Œå¯ä»¥å‚çœ‹ï¼š<a href=https://cloud.tencent.com/developer/article/1900658 target=_blank rel="external nofollow noopener noreferrer">å°ç™½ä¹Ÿèƒ½çœ‹æ‡‚çš„contextåŒ…è¯¦è§£ï¼šä»å…¥é—¨åˆ°ç²¾é€š<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></blockquote></details><h4 id=-grpcä¸ºå•¥å¥½åŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆå’Œhttpæ¯”å‘¢>ğŸ¥® grpcä¸ºå•¥å¥½ï¼ŒåŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆï¼Œå’Œhttpæ¯”å‘¢</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>å®˜æ–¹ä»‹ç»ï¼šgRPC æ˜¯ä¸€ä¸ªç°ä»£å¼€æºçš„é«˜æ€§èƒ½è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ (RPC) æ¡†æ¶ï¼Œå¯ä»¥åœ¨ä»»ä½•ç¯å¢ƒä¸­è¿è¡Œã€‚å®ƒå¯ä»¥é€šè¿‡å¯¹è´Ÿè½½å¹³è¡¡ã€è·Ÿè¸ªã€å¥åº·æ£€æŸ¥å’Œèº«ä»½éªŒè¯çš„å¯æ’æ‹”æ”¯æŒæœ‰æ•ˆåœ°è¿æ¥æ•°æ®ä¸­å¿ƒå†…å’Œè·¨æ•°æ®ä¸­å¿ƒçš„æœåŠ¡ã€‚å®ƒä¹Ÿé€‚ç”¨äºåˆ†å¸ƒå¼è®¡ç®—çš„æœ€åä¸€è‹±é‡Œï¼Œå°†è®¾å¤‡ã€ç§»åŠ¨åº”ç”¨ç¨‹åºå’Œæµè§ˆå™¨è¿æ¥åˆ°åç«¯æœåŠ¡ã€‚</em></p><p><strong>åŒºåˆ«ï¼š</strong></p><ol><li>rpcæ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œå°±æ˜¯æœ¬åœ°å»è°ƒç”¨ä¸€ä¸ªè¿œç¨‹çš„å‡½æ•°ï¼Œè€Œhttpæ˜¯é€šè¿‡ urlå’Œç¬¦åˆrestfulé£æ ¼çš„æ•°æ®åŒ…å»å‘é€å’Œè·å–æ•°æ®ï¼›</li><li>rpcçš„ä¸€èˆ¬ä½¿ç”¨çš„ç¼–è§£ç åè®®æ›´åŠ é«˜æ•ˆï¼Œæ¯”å¦‚grpcä½¿ç”¨protobufç¼–è§£ç ã€‚è€Œhttpçš„ä¸€èˆ¬ä½¿ç”¨jsonè¿›è¡Œç¼–è§£ç ï¼Œæ•°æ®ç›¸æ¯”rpcæ›´åŠ ç›´è§‚ï¼Œä½†æ˜¯æ•°æ®åŒ…ä¹Ÿæ›´å¤§ï¼Œæ•ˆç‡ä½ä¸‹ï¼›</li><li>rpcä¸€èˆ¬ç”¨åœ¨æœåŠ¡å†…éƒ¨çš„ç›¸äº’è°ƒç”¨ï¼Œè€Œhttpåˆ™ç”¨äºå’Œç”¨æˆ·äº¤äº’ï¼›</li></ol><p><strong>ç›¸ä¼¼ç‚¹ï¼š</strong></p><p>éƒ½æœ‰ç±»ä¼¼çš„æœºåˆ¶ï¼Œä¾‹å¦‚grpcçš„metadataæœºåˆ¶å’Œhttpçš„å¤´æœºåˆ¶ä½œç”¨ç›¸ä¼¼ï¼Œè€Œä¸”webæ¡†æ¶ï¼Œå’Œrpcæ¡†æ¶ä¸­éƒ½æœ‰æ‹¦æˆªå™¨çš„æ¦‚å¿µã€‚grpcä½¿ç”¨çš„æ˜¯http2.0åè®®ã€‚</p><p>å®˜ç½‘ï¼š<a href=https://grpc.io/ target=_blank rel="external nofollow noopener noreferrer">gRPC<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></details><h4 id=å®ç°ä½¿ç”¨å­—ç¬¦ä¸²å‡½æ•°åè°ƒç”¨å‡½æ•°>ğŸ¡å®ç°ä½¿ç”¨å­—ç¬¦ä¸²å‡½æ•°åï¼Œè°ƒç”¨å‡½æ•°ã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>æ€è·¯ï¼šé‡‡ç”¨åå°„çš„Callæ–¹æ³•å®ç°ã€‚</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;reflect&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Animal</span> <span class=kd>struct</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>a</span> <span class=o>*</span><span class=nx>Animal</span><span class=p>)</span> <span class=nf>Eat</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;Eat&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=nx>a</span> <span class=o>:=</span> <span class=nx>Animal</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=nx>reflect</span><span class=p>.</span><span class=nf>ValueOf</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>a</span><span class=p>).</span><span class=nf>MethodByName</span><span class=p>(</span><span class=s>&#34;Eat&#34;</span><span class=p>).</span><span class=nf>Call</span><span class=p>([]</span><span class=nx>reflect</span><span class=p>.</span><span class=nx>Value</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h4 id=-goroutineæœ‰ä¸‰ä¸ªå‡½æ•°åˆ†åˆ«æ‰“å°cat-fishdogè¦æ±‚æ¯ä¸€ä¸ªå‡½æ•°éƒ½ç”¨ä¸€ä¸ªgoroutineæŒ‰ç…§é¡ºåºæ‰“å°100æ¬¡>ğŸ¥Ÿ ï¼ˆGoroutineï¼‰æœ‰ä¸‰ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«æ‰“å°"cat", &ldquo;fish&rdquo;,&ldquo;dog"è¦æ±‚æ¯ä¸€ä¸ªå‡½æ•°éƒ½ç”¨ä¸€ä¸ªgoroutineï¼ŒæŒ‰ç…§é¡ºåºæ‰“å°100æ¬¡ã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>æ­¤é¢˜ç›®è€ƒå¯Ÿchannelï¼Œç”¨ä¸‰ä¸ªæ— ç¼“å†²channelï¼Œå¦‚æœä¸€ä¸ªchannelæ”¶åˆ°ä¿¡å·åˆ™é€šçŸ¥ä¸‹ä¸€ä¸ªã€‚</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>dog</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>cat</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>fish</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Dog</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=o>&lt;-</span><span class=nx>fish</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;dog&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>dog</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Cat</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=o>&lt;-</span><span class=nx>dog</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;cat&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>cat</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>Fish</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=o>&lt;-</span><span class=nx>cat</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;fish&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>fish</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>100</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>go</span> <span class=nf>Dog</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=k>go</span> <span class=nf>Cat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=k>go</span> <span class=nf>Fish</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>fish</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>10</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h4 id=-ä¸¤ä¸ªåç¨‹äº¤æ›¿æ‰“å°10ä¸ªå­—æ¯å’Œæ•°å­—>ğŸ¦€ ä¸¤ä¸ªåç¨‹äº¤æ›¿æ‰“å°10ä¸ªå­—æ¯å’Œæ•°å­—</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>æ€è·¯ï¼šé‡‡ç”¨channelæ¥åè°ƒgoroutineä¹‹é—´é¡ºåºã€‚</em></p><p><em>ä¸»çº¿ç¨‹ä¸€èˆ¬è¦waitGroupç­‰å¾…åç¨‹é€€å‡ºï¼Œè¿™é‡Œç®€åŒ–äº†ä¸€ä¸‹ç›´æ¥sleepã€‚</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>word</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{},</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>num</span> <span class=p>=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{},</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>printNums</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=o>&lt;-</span><span class=nx>word</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>num</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>printWords</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=o>&lt;-</span><span class=nx>num</span>
</span></span><span class=line><span class=cl>		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;a&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>word</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>num</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=nf>printNums</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=nf>printWords</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span> <span class=o>*</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h4 id=-å¯åŠ¨-2ä¸ªgroutine-2ç§’åå–æ¶ˆ-ç¬¬ä¸€ä¸ªåç¨‹1ç§’æ‰§è¡Œå®Œç¬¬äºŒä¸ªåç¨‹3ç§’æ‰§è¡Œå®Œ>ğŸ¦ å¯åŠ¨ 2ä¸ªgroutine 2ç§’åå–æ¶ˆï¼Œ ç¬¬ä¸€ä¸ªåç¨‹1ç§’æ‰§è¡Œå®Œï¼Œç¬¬äºŒä¸ªåç¨‹3ç§’æ‰§è¡Œå®Œã€‚</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>æ€è·¯ï¼šé‡‡ç”¨ctx, _ := context.WithTimeout(context.Background(), time.Second*2)å®ç°2så–æ¶ˆã€‚åç¨‹æ‰§è¡Œå®Œåé€šè¿‡channelé€šçŸ¥ï¼Œæ˜¯å¦è¶…æ—¶ã€‚</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>f1</span><span class=p>(</span><span class=nx>in</span> <span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>1</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>in</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>f2</span><span class=p>(</span><span class=nx>in</span> <span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>in</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ch1</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>	<span class=nx>ch2</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>context</span><span class=p>.</span><span class=nf>WithTimeout</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span> <span class=mi>2</span><span class=o>*</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>go</span> <span class=nf>f1</span><span class=p>(</span><span class=nx>ch1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>case</span> <span class=o>&lt;-</span><span class=nx>ctx</span><span class=p>.</span><span class=nf>Done</span><span class=p>():</span>
</span></span><span class=line><span class=cl>			<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;f1 timeout&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>break</span>
</span></span><span class=line><span class=cl>		<span class=k>case</span> <span class=o>&lt;-</span><span class=nx>ch1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;f1 done&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>go</span> <span class=nf>f2</span><span class=p>(</span><span class=nx>ch2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>case</span> <span class=o>&lt;-</span><span class=nx>ctx</span><span class=p>.</span><span class=nf>Done</span><span class=p>():</span>
</span></span><span class=line><span class=cl>			<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;f2 timeout&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>break</span>
</span></span><span class=line><span class=cl>		<span class=k>case</span> <span class=o>&lt;-</span><span class=nx>ch2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;f2 done&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}()</span>
</span></span><span class=line><span class=cl>	<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nx>Second</span> <span class=o>*</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h4 id=-å½“selectç›‘æ§å¤šä¸ªchanåŒæ—¶åˆ°è¾¾å°±ç»ªæ€æ—¶å¦‚ä½•å…ˆæ‰§è¡ŒæŸä¸ªä»»åŠ¡>ğŸ¦ å½“selectç›‘æ§å¤šä¸ªchanåŒæ—¶åˆ°è¾¾å°±ç»ªæ€æ—¶ï¼Œå¦‚ä½•å…ˆæ‰§è¡ŒæŸä¸ªä»»åŠ¡ï¼Ÿ</h4><details><summary>å±•å¼€æŸ¥çœ‹è¯¦æƒ…</summary><p><em>å¯ä»¥åœ¨å­caseå†åŠ ä¸€ä¸ªfor selectè¯­å¥ã€‚</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>priority_select</span><span class=p>(</span><span class=nx>ch1</span><span class=p>,</span> <span class=nx>ch2</span> <span class=o>&lt;-</span><span class=kd>chan</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>case</span> <span class=nx>val</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>ch1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>case</span> <span class=nx>val2</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>ch2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nx>priority</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=k>for</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>select</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>case</span> <span class=nx>val1</span> <span class=o>:=</span> <span class=o>&lt;-</span><span class=nx>ch1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>					<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>val1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>				<span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>					<span class=k>break</span> <span class=nx>priority</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>val2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details></div><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>æ–‡ç« æœ‰å¸®åˆ°æ‚¨çš„è¯ï¼Œè¯·æˆ‘å–æ¯å¥¶èŒ¶å§ãƒ¾(â—Â´âˆ€ï½€â—)</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=/images/alipay.jpg>
<span>æ”¯ä»˜å®æ‰“èµ</span></label>
<label class=qr-code-image for=reward><img class=image src=/images/wepay.jpg>
<span>å¾®ä¿¡æ‰“èµ</span></label></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2022-10-18 17:47:50">æ›´æ–°äº 2022-10-18&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98/index.md title=é˜…è¯»åŸå§‹æ–‡æ¡£ class=link-to-markdown>é˜…è¯»åŸå§‹æ–‡æ¡£</a></span><span><a href=https://github.com/kendrickcheung/begi/edit/main/content/posts/Go%e8%af%ad%e8%a8%80/%e9%9d%a2%e8%af%95/Go%e8%af%ad%e8%a8%80%e9%9d%a2%e8%af%95%e9%a2%98.md title=ç¼–è¾‘æ­¤é¡µ target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>ç¼–è¾‘æ­¤é¡µ</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="åˆ†äº«åˆ° Twitter" data-sharer=twitter data-url=https://kendrickcheung.github.io/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98/ data-title=ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ data-hashtags=zhihu,interview,Golang><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="åˆ†äº«åˆ° Facebook" data-sharer=facebook data-url=https://kendrickcheung.github.io/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98/ data-hashtag=zhihu><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="åˆ†äº«åˆ° Hacker News" data-sharer=hackernews data-url=https://kendrickcheung.github.io/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98/ data-title=ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ><i class="fa-brands fa-hacker-news fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="åˆ†äº«åˆ° Line" data-sharer=line data-url=https://kendrickcheung.github.io/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98/ data-title=ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a>
<a href=javascript:void(0); title="åˆ†äº«åˆ° å¾®åš" data-sharer=weibo data-url=https://kendrickcheung.github.io/go%E8%AF%AD%E8%A8%80%E9%9D%A2%E8%AF%95%E9%A2%98/ data-title=ã€æ‘˜æŠ„ã€‘Goå¸¸è§é¢è¯•é¢˜ã€ç”±æµ…å…¥æ·±ã€‘2022ç‰ˆ><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/zhihu/>çŸ¥ä¹</a>,&nbsp;<a href=/tags/interview/>é¢è¯•</a>,&nbsp;<a href=/tags/golang/>Goè¯­è¨€</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>è¿”å›</a></span>&nbsp;|&nbsp;<span><a href=/>ä¸»é¡µ</a></span></section></div><div class=post-nav><a href=/%E8%8B%B1%E8%AF%AD%E6%99%A8%E8%AF%BB%E4%B8%80/ class=prev rel=prev title=ã€è‹±è¯­æ™¨è¯»ã€‘é•¿è£æµ·è¿å¹´ç»ˆå¥–å‘40ä¸ªæœˆè–ªã€å›½é™…å¤§äº‹><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>ã€è‹±è¯­æ™¨è¯»ã€‘é•¿è£æµ·è¿å¹´ç»ˆå¥–å‘40ä¸ªæœˆè–ªã€å›½é™…å¤§äº‹</a>
<a href=/%E5%90%8E%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E9%9B%8601/ class=next rel=next title=ã€æ‘˜æŠ„ã€‘åç«¯é¢è¯•é¢˜é›†01>ã€æ‘˜æŠ„ã€‘åç«¯é¢è¯•é¢˜é›†01<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=giscus><script src=https://giscus.app/client.js data-repo=kendrickcheung/kendrickcheung.github.io data-repo-id=R_kgDOILbtyQ data-category=General data-category-id=DIC_kwDOILbtyc4CR5sB data-mapping=title data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line powered">ç”± <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.104.3">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.17-RC"><img class=fixit-icon src=/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2021 - 2022</span><span class=author itemprop=copyrightHolder>
<a href=https://kendrickcheung.github.io/ target=_blank rel="external nofollow noopener noreferrer">Kendrick</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class=site-time title='ç½‘ç«™è¿è¡Œä¸­ ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i>&nbsp;<span class=run-times>ç½‘ç«™è¿è¡Œä¸­ ...</span></span></div><div class="footer-line ibruce"><span id=busuanzi_container_site_uv title=æ€»è®¿å®¢æ•°><i class="fa-regular fa-user fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=æ€»è®¿é—®é‡><i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=å›åˆ°é¡¶éƒ¨><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=æŸ¥çœ‹è¯„è®º><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/kendrickcheung/begi title="åœ¨ GitHub ä¸ŠæŸ¥çœ‹æºä»£ç " target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#000;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>FixIt ä¸»é¢˜åœ¨å¯ç”¨ JavaScript çš„æƒ…å†µä¸‹æ•ˆæœæœ€ä½³ã€‚</div></noscript></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/algoliasearch/algoliasearch-lite.umd.min.js defer></script><script src=/lib/lazysizes/lazysizes.min.js async defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script>window.config={code:{copyTitle:"å¤åˆ¶åˆ°å‰ªè´´æ¿",editLockTitle:"é”å®šå¯ç¼–è¾‘ä»£ç å—",editUnLockTitle:"è§£é”å¯ç¼–è¾‘ä»£ç å—",editable:!0,maxShownLines:10},comment:{enable:!0,giscus:{darkTheme:"dark_dimmed",lightTheme:"light"}},cookieconsent:{content:{dismiss:"åŒæ„",link:"äº†è§£æ›´å¤š",message:"æœ¬ç½‘ç«™ä½¿ç”¨ Cookies æ¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒã€‚"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},enablePWA:!0,enablePangu:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"2R1K9SKLQZ",algoliaIndex:"index.zh-cn",algoliaSearchKey:"4a226aa1c5c98d6859e4d1386adb2bc7",highlightTag:"em",maxResultLength:10,noResultsFound:"æ²¡æœ‰æ‰¾åˆ°ç»“æœ",snippetLength:50,type:"algolia"},siteTime:"2021-12-18T16:15:22+08:00",watermark:{content:'\u003cimg class="fixit-icon" src="/fixit.min.svg" alt="FixIt logo" /\u003e FixIt ä¸»é¢˜',enable:!0,height:21,opacity:.0125}}</script><script src=/js/theme.min.js defer></script><script src=/js/custom.min.js defer></script></body></html>